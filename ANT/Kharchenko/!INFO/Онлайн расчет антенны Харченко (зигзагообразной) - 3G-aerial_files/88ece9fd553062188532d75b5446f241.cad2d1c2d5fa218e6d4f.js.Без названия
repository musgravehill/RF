(window.webpackJsonp=window.webpackJsonp||[]).push([["88ece9fd553062188532d75b5446f241"],{"7GuL":function(e,t,a){"use strict";a.r(t),a.d(t,"ATTACH_DATA_DONUT_DURATION",(function(){return n})),a.d(t,"MEDIA_TYPE_DONUT_DURATION",(function(){return r})),a.d(t,"POST_PARAM_DONUT_DURATION",(function(){return o})),a.d(t,"donutVisibilityInit",(function(){return k})),a.d(t,"getDonutPostParams",(function(){return I})),a.d(t,"getPostParamsFromDurationMedia",(function(){return C})),a.d(t,"fieldValueIsDonutOnlyPost",(function(){return T})),a.d(t,"updatePostponedPostDonatorIcon",(function(){return x})),a.d(t,"isPaidAttachPicked",(function(){return S}));var i,o="donut_duration",n="donut_duration",r="donut_duration",s=a("BTjd"),d=a("zxIV"),l=a("t7n3"),c=a("oK+H"),p=function(e,t,a){a?Object(d.domInsertAfter)(e,a):t&&(t.firstChild?Object(d.domInsertBefore)(e,t.firstChild):e&&t.appendChild(e))},_=a("vkK6"),u=a("Egk5"),h=a("v+DW"),g=function(e,t){var a=function(e){if(!(e instanceof Element)||"submit_post_box"!==e.id)return!0;var t=parseInt(Object(d.domData)(e,"from-oid"))||void 0;return!!t&&t<0}(e),i=function(e){var t,a=null===(t=null==e?void 0:e.markAsAdsGetCheckboxEl)||void 0===t?void 0:t.call(e);return!a||!!!Object(h.isChecked)(a)}(t);return a&&i},m=function(e){var t,a=null===(t=null==e?void 0:e[5])||void 0===t?void 0:t[n];return void 0!==a?a:void 0},v=a("HLtZ"),b=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return b(t,e),t}(Error),w=function(){function e(t,a){var i=this;this.containerEl=t,this.addMedia=a,this.updateView=function(){i.isInitialized&&(i.actionsUpdateVisibilityView()&&(i.tooltipVisibilityUpdateView(),i.tooltipDurationUpdateView()))},this.chooseDonutVisibility=function(t){var a,o,n=e.getEventParams(t);if(!n)return!1;null===(o=null===(a=i.tooltipDonutVisibility)||void 0===a?void 0:a.hide)||void 0===o||o.call(a),i.setDonutDuration(n.donut_duration)},this.chooseDonutDuration=function(t){var a,o,n=e.getEventParams(t);if(!n)return!1;null===(o=null===(a=i.tooltipDonutDuration)||void 0===a?void 0:a.hide)||void 0===o||o.call(a),i.setDonutDuration(n.donut_duration)};try{this.tooltipVisibilityInitView(),this.tooltipDurationInitView(),this.isInitialized=!0,this.updateView();var o=this.getEmitter();o&&o.on(this.addMedia.eventTypes.mediaUpdate,this.updateView)}catch(e){e instanceof f||Object(v.logError)(e),this.isInitialized=!1}}return e.prototype.setPostDonutOnly=function(){this.setDonutDuration(-1)},e.prototype.donutUpdateVisibility=function(e){this.actionsUpdateVisibilityView(e)},e.prototype.getEmitter=function(){return this.addMedia.emitter},e.prototype.tooltipVisibilityInitView=function(){var t,a=this.getLnkId(),i=Object(l.getTemplate)("visibility_access_donut",{link_id:a});if(!i)throw new f;if(this.visibilityTooltipEl=Object(d.se)(i),!this.visibilityTooltipEl)throw new f;p(this.visibilityTooltipEl,this.containerEl),this.tooltipDonutVisibility=null===(t=Object(c.createPostTooltip)(e.TOOLTIP_VISIBILITY_NAME,a))||void 0===t?void 0:t.toooltip,Object(s.default)(this.containerEl,e.TOOLTIP_VISIBILITY_OPTION_SELECTOR,"click",this.chooseDonutVisibility)},e.prototype.tooltipDurationInitView=function(){var t,a=this.getLnkId(),i=Object(l.getTemplate)("donut_duration_select",{link_id:a});if(!i)throw new f;if(this.durationTooltipEl=Object(d.se)(i),!this.durationTooltipEl)throw new f;p(this.durationTooltipEl,this.containerEl,this.visibilityTooltipEl),this.tooltipDonutDuration=null===(t=Object(c.createPostTooltip)(e.TOOLTIP_DURATION_NAME,a))||void 0===t?void 0:t.toooltip,Object(s.default)(this.containerEl,e.TOOLTIP_DURATION_OPTION_SELECTOR,"click",this.chooseDonutDuration)},e.prototype.getLnkId=function(){return this.addMedia.lnkId},e.getEventParams=function(e){var t,a=e.target;return!Object(u.checkEvent)(e)&&a instanceof HTMLElement&&(null===(t=Object(_.getActionData)(a))||void 0===t?void 0:t.actionParams)},e.prototype.setDonutDuration=function(t){var a;e.isDurationValueEmpty(t)?this.addMedia.unchooseMediaForType(r):this.addMedia.addOrUpdateChosenMedia(r,"",((a={})[n]=t,a))},e.isDurationValueEmpty=function(e){return null===e},e.prototype.getTooltipVisibilityActiveElement=function(t){var a=null!==t?-1:null;return this.containerEl.querySelector(e.TOOLTIP_VISIBILITY_OPTION_SELECTOR+'[data-value="'+a+'"]')},e.prototype.getTooltipDurationActiveElement=function(t){return this.containerEl.querySelector(e.TOOLTIP_DURATION_OPTION_SELECTOR+'[data-value="'+t+'"]')},e.prototype.getActiveDurationOption=function(){var e=this.addMedia.findChosenMedia(r),t=e?m(e):void 0;return void 0!==t?t:null},e.prototype.tooltipVisibilityUpdateView=function(){var t=this.getActiveDurationOption(),a=String(this.getLnkId())||"",i=this.getTooltipVisibilityActiveElement(t),o=!e.isDurationValueEmpty(t),n=this.visibilityTooltipEl;Object(h.radiobtn)(i,t,"post_settings_btn"+e.TOOLTIP_VISIBILITY_NAME+a);var r=null==n?void 0:n.querySelector(".post_action_btn_text"),s=i&&Object(d.val)(i)||"";r&&s&&(r.innerHTML=s,r.setAttribute("aria-label",Object(l.replaceEntities)(s))),Object(d.toggleClass)(n,"on",o)},e.prototype.tooltipDurationUpdateView=function(){var t=this.getActiveDurationOption(),a=String(this.getLnkId())||"",i=this.getTooltipDurationActiveElement(t),o=!e.isDurationValueEmpty(t),n=o&&!!t&&t>0,r=this.durationTooltipEl;Object(h.radiobtn)(i,t,"post_settings_btn"+e.TOOLTIP_DURATION_NAME+a);var s=null==r?void 0:r.querySelector(".post_action_btn_text"),c=n?i&&Object(d.val)(i):Object(d.domData)(s,"empty"),p=i?c:"";s&&p&&(s.innerHTML=p,s.setAttribute("aria-label",Object(l.replaceEntities)(p))),Object(d.toggleClass)(r,"on",n),Object(d.toggleClass)(r,"visible",o);var _=this.addMedia.markAsAdsGetCheckboxEl();_&&Object(h.disable)(_,o)},e.prototype.actionsUpdateVisibilityView=function(e){var t=null!=e?e:this.getPostboxForNewPost(),a=g(t,this.addMedia);return this.visibilityTooltipEl&&this.durationTooltipEl?(Object(d.toggleClass)(this.containerEl,"post_actions_btns--donut-actions-hidden",!a),a):a},e.prototype.getPostboxForNewPost=function(){return"post_actions_btns"===this.containerEl.id?document.querySelector("#submit_post_box"):null},e.TOOLTIP_DURATION_NAME="post_donut_duration_btn",e.TOOLTIP_DURATION_OPTION_SELECTOR='[data-onclick="toggleDonutPostDuration"]',e.TOOLTIP_VISIBILITY_NAME="donut_visibility_btn",e.TOOLTIP_VISIBILITY_OPTION_SELECTOR='[data-onclick="toggleDonutPostVisibility"]',e}(),k=function(e){var t=e.actionsEl,a=e.addMedia;if(t instanceof Element){var i=new w(t,a);return{donutPostSettings:i.isInitialized?i:void 0}}},y=a("aong"),C=function(e){var t,a=m(e);return void 0!==a?((t={})[o]=a,t):void 0},M=function(e){var t=e.findChosenMedia(r);return m(t)},T=function(e,t){return void 0!==(t&&M(t))&&g(e,t)?1:0},I=function(e,t){var a;if(e&&t){var i=M(t)||-1;return(a={})[o]=i,a.mark_as_ads=0,a}},x=function(e,t){if(e instanceof Element){var a=!!(null==t?void 0:t.is_marked_as_donut),i=e.querySelector('[data-section-ref="donut-post-donator-icon"]');if(a){var o,n,r,s=e.querySelector(".post_date"),c=Object(l.getTemplate)("postDonatorIcon");if(s&&c)o=s,n=Object(d.se)(c),(r=i)?Object(d.domReplaceEl)(r,n):o.appendChild(n)}else null==i||i.remove()}},S=function(e,t){return e.getMedias().some((function(e){return function(e,t){var a;switch(e[0]){case"article":var i=null==e?void 0:e[5],o=(null==i?void 0:i.owner_id)===t;return Boolean(o&&(null==i?void 0:i.is_donut));case"podcast":var n=null===(a=null==e?void 0:e[5])||void 0===a?void 0:a.audio,r=null==n?void 0:n[12];o=(null==n?void 0:n[1])===t;return Boolean(o&&Object(y.parseJSON)(r).paid);default:return!1}}(e,t)}))}},BTjd:function(e,t,a){"use strict";a.r(t);const i=new WeakMap;function o(e,t,a,o){var n,r;if(!e&&!i.has(t))return!1;const s=null!==(n=i.get(t))&&void 0!==n?n:new WeakMap;if(i.set(t,s),!e&&!i.has(t))return!1;const d=null!==(r=s.get(a))&&void 0!==r?r:new Set;s.set(a,d);const l=d.has(o);return e?d.add(o):d.delete(o),l&&e}t.default=function e(t,a,i,n,r){if("string"==typeof t&&(t=document.querySelectorAll(t)),"function"!=typeof t.addEventListener){const o=Array.prototype.map.call(t,t=>e(t,a,i,n,r));return{destroy(){o.forEach(e=>e.destroy())}}}const s=t,d=Boolean("object"==typeof r?r.capture:r),l=e=>{const t=e.target.closest(a);t&&(e.delegateTarget=t,e.currentTarget.contains(e.delegateTarget)&&n.call(s,e))},c=JSON.stringify({selector:a,type:i,capture:d}),p={destroy(){s.removeEventListener(i,l,r),o(!1,s,n,c)}};return o(!0,s,n,c)||s.addEventListener(i,l,r),p}},EIqf:function(e,t,a){"use strict";function i(){return a.e("youla_item_create").then(a.bind(null,"cIWr")).then((function(e){return e.YoulaItemCreate}))}a.r(t),a.d(t,"preloadYoulaItemCreate",(function(){return i}))},"oK+H":function(e,t,a){"use strict";a.r(t),a.d(t,"createPostTooltip",(function(){return n}));var i=a("zxIV"),o=a("k487"),n=(e,t,a)=>{var n=t||"",r=e+n,s=Object(i.ge)(r),d=Object(i.geByClass1)("post_action_tt_content",s),l=Object(i.geByClass1)("post_action_btn_layout",s),c=d.children;if(window.radioBtns["post_settings_btn"+e+n]={val:!1,els:c},!Object(i.hasClass)(s,"disabled")){var p=[-12*(window.vk.rtl?-1:1),7],_=new o.default(l,{appendTo:s,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:p,content:d,align:"left",onFirstTimeShow:()=>{Object(i.show)(d)}});return cur[e+n]=_,cur.destroy.push((function(){_&&_.destroy()})),a&&(cur[e+n+"_onChange"]=a),{toooltip:_}}}},te1c:function(e,t,a){"use strict";a.r(t),a.d(t,"MEDIA_SELECTOR_GROUP",(function(){return w})),a.d(t,"MediaSelector",(function(){return D}));a("HEwt"),a("rE2o"),a("ioFf"),a("rGqo"),a("VRzm"),a("Vd3H"),a("a1Th"),a("Btvt"),a("KKXr"),a("Oyvg"),a("SRfc"),a("91GP"),a("pIFo");var i=a("v+DW"),o=a("EasH"),n=a("FWc3"),r=a("ER42"),s=a("wetz"),d=a("t7n3"),l=a("/PiP"),c=a("W9Tc"),p=a("7GuL"),_=a("nqXl"),u=a("jE6c"),h=a("uQjJ"),g=a("821F");var m=a("EIqf");function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],i=!0,o=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){o=!0,n=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=new Array(t);a<t;a++)i[a]=e[a];return i}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}var w="group",k=p.MEDIA_TYPE_DONUT_DURATION,y="anonymous",C="poll_fixed",M="poll_closed",T="poll_background_id",I="poll_photo_id",x="poll_until",S="poll_is_multiple",P="poll_disable_unvote",A=/^invite\/[a-zA-Z0-9]{7}$|/,D=function(e,t,a,b,D,B){var E,$=[],L=(b=b||{}).mediaHandlers||{},O=b.from;each(a||[],(function(t,a){var r=a[0],s=a[1],d=a[2];if(s){var l=!1,c=b.toId||cur.postTo,p={to_id:c,blockPersonal:b.blockPersonal};p.mail_add=b.mail?1:"",p.from=b.from;var _={};switch(r){case"graffiti":l=showBox.pbind("al_wall.php",{act:"canvas_draw_box",flash:browser.flash},{cache:1,dark:1});break;case"photos_list":l=showBox.pbind("al_photos.php",extend(p,{act:"choose_photo"}),{cache:1,stat:[jsc("web/photos.js"),"photos.css",jsc("web/upload.js")],dark:1});break;case"photo":l=L.photo?L.photo.pbind(b):showBox.pbind("al_photos.php",extend(p,{act:"choose_photo",max_files:b.limit||10,no_album_select:~(b.disabledTypes||[]).indexOf("album")?1:""}),{cache:1,stat:[jsc("web/photos.js"),"photos.css",jsc("web/upload.js")],dark:1});break;case"video":var u=extend(p,{act:"a_choose_video_box",max_files:b.limit||10});l=function(){var t=domClosest("_submit_post_box",e);hasClass(t,"anon_field_on")||showBox("al_video.php",u,{cache:1,dark:1})};break;case"audio":l=function(){var t=domClosest("_submit_post_box",e);hasClass(t,"anon_field_on")||stManager.add([jsc("web/audio.js"),jsc("web/indexer.js"),jsc("web/auto_list.js"),jsc("web/grid_sorter.js"),"audio.css"],(function(){var t=!1;each(E.chosenMedias||[],(function(){"audio_playlist"===this[0]&&(t=!0)})),cur.audioAttachOriginalOwnerId=!1,cur.audioAttachSwitchOwnerId=!1;var a=vk.id,i=parseInt((""+p.to_id||"").replace(/^board/,"-")),o=domClosest("_submit_post_box",e);domData(o,"from-oid")<0||"im"===cur.module&&cur.gid?(a=i,cur.audioAttachOriginalOwnerId=i,cur.audioAttachSwitchOwnerId=vk.id):cur.hasGroupAudioAccess&&(cur.audioAttachOriginalOwnerId=vk.id,cur.audioAttachSwitchOwnerId=i),AudioPage.showAttachBox(a,{canPlaylistAttach:!t&&!cur.editor,onAudioChoose:AudioUtils.onAudioChoose,onPlaylistChoose:AudioUtils.onPlaylistChoose})}))};break;case"poll":l=()=>E.chooseMedia("poll","",d);break;case"doc":l=L.doc?L.doc.pbind(b):showBox.pbind("docs.php",Object.assign(p,b.docParams,{act:"a_choose_doc_box"}),{stat:["docs.css"]});break;case"map":l=showBox.pbind("al_places.php",extend(p,{act:"a_choose_place_box"}),{stat:["places.css","map.css","maps.js","ui_controls.css","ui_controls.js","boxes.css"],width:640,bodyStyle:"padding: 0px;",dark:1});break;case"note":l=showWiki.pbind({note:"new"},!0,!1,{queue:1});break;case"postpone":l=e=>{if(B){if(hasClass(e.target,"_close"))return E.unchooseMedia(E.postponeInd),void cancelEvent(e);var t=()=>{cur["postPostponeTT"+E.lnkId].show(),triggerEvent(geByClass1("datepicker_control",cur["postPostponeTT"+E.lnkId]._ttel),"mousedown",!1,!0);var e=!E.postponeDate;E.postponeDate=val("postpone_date"+E.lnkId),e&&E.chooseMedia("postpone",E.postponeDate,d)};E.postponeDatepicker?"DP_PLACEHOLDER"!==E.postponeDatepicker&&t():(cur.postponedLastDate&&(d.date=intval(cur.postponedLastDate)+3600),E.postponeDatepicker="DP_PLACEHOLDER",E.setupPostpone(d,null,t))}else E.chooseMedia("postpone",s,d)};break;case k:_.onMediaTypeInit=e=>{e.addMedia.donutVisibilityAddSelect&&e.addMedia.donutVisibilityAddSelect(e)},l=()=>{};break;case"mark_as_ads":l=()=>E.chooseMedia("mark_as_ads",s,d);break;case"share":l=function(e){e=e||{},window.onShareChooseUrlBoxInit=function(){var e=geByClass1("share_url_input",curBox().bodyNode);addEvent(e,"keydown",(function(e){if(e.which==KEY.ENTER)return a(curBox().btns.ok[0],e),!1}))};var t=showBox("share.php",{act:"choose_url_box"},{dark:1}),a=function(a,o){var n=geByClass1("share_url_input",t.bodyNode),r=val(n);Object(i.lockButton)(a),disable(n,!0),hide("share_url_error"),E.chooseMedia("share",s,extend(d,{url:r,draft:!0,onSuccess:function(){disable(n,!1),Object(i.unlockButton)(a),t.hide(),e.videoId&&window.AdsEdit&&window.AdsEdit.showSnippetVideo&&window.AdsEdit.showSnippetVideo(e.videoId)},onError:function(e){var t="";e&&e!==getLang("global_unknown_error")&&-1===e.indexOf("ERR_PAGE_GET_FAILED")&&(t=e+" "),disable(n,!1),Object(i.unlockButton)(a),ge("share_url_error").innerHTML=t+getLang("global_share_link_failed"),show("share_url_error")}}))};t.removeButtons(),t.addButton(getLang("global_continue"),a)};break;case"pretty_cards":l=function(e){e&&e.replace_owner_id&&(d.editor.owner_id=e.replace_owner_id),E.chooseMedia("pretty_cards",s,d)};break;case"gift":l=function(){var e=(e=b.peer<2e9?b.peer:0)||cur.peer;b.giftBoxPrepare&&b.giftBoxPrepare(e),showBox("al_gifts.php",{act:"get_gift_box",mid:e,fr:e==vk.id?1:0,ref:"media_selector"},{stat:["gifts.css","wide_dd.js","wide_dd.css"],dark:1})};break;case"money":l=function(){var e=cur.peer;c>-2e9&&c<0&&(p.owner_id=c),g.MoneyTransfer.showMoneyTransferBox(extend(p,{to_id:e}),{},e=>(curBox()&&curBox().hide(),setTimeout(Object(o.showFastBox)(getLang("global_error"),e).hide,2e3),!0))};break;case"market":c==vk.id?(l=showBox.pbind("al_market.php",extend(p,{act:"a_choose_user_product_box"}),{cache:1}),d.tt_words&&(cur.checkMessageHandler=function(e){if(!cur.marketIntroShown&&(e=" "+e+" ").match(new RegExp("\\s("+d.tt_words.join("|")+")\\s","i"))){var t=getSize(E.menu.moreWrap);Object(n.showTooltip)(E.menu.moreWrap,{text:d.tt_text,dir:"left",slideX:15,width:230,shift:[-t[0]-5,-t[1]/2],hasover:1}),cur.marketIntroShown=!0}})):l=showBox.pbind("al_market.php",extend(p,{act:"a_choose_product_box"}),{cache:1});break;case"youla":l=()=>{Object(m.preloadYoulaItemCreate)().then(e=>{e.open()})};break;case"market_services":l=()=>{showBox("/al_market.php",f({act:"a_choose_product_box"},p,{album_id:-2}),{cache:1})};break;case"article":l=()=>openArticleEditor(c);break;case"podcast":l=function(){stManager.add([jsc("web/podcast.js")],(function(){Podcast.select()}))}}l&&$.push([r,s,l,_])}})),t=ge(t||"media_preview"),D=!1!==D&&ge(D||"post_settings_btn"),B=!1!==B&&ge(B||"post_actions_btns");var N=b.limit||10,j=cur.pbIsTextlive||N>1,U=b.editable&&(!browser.msie||parseInt(browser.version)>8),R=b.sortable&&(!browser.msie||parseInt(browser.version)>8),z=!!B,q=function(e,t,a){if(!(e=ge(e)))return!1;a=a||{},window.__addMediaIndex||(window.__addMediaIndex=0);var i=++__addMediaIndex;e.innerHTML='<div class="media_selector clear_fix"></div>';var o,n=domByClass(e,"media_selector"),r=[],s={id:i,menuNode:n,types:t,lastTypes:t,activate:function(e){s.touched=!0===e,a.onActivate&&a.onActivate()},show:function(){if(o&&(clearTimeout(o),o=0),s.moreWrap&&!hasClass(s.moreWrap,"shown")){a.forceToUp||replaceClass(s.moreWrap,"to_up","to_down");var e=domByClass(s.moreWrap,"_more_items");(getClientRectOffsetY(e)>0||a.forceToUp)&&replaceClass(s.moreWrap,"to_down","to_up"),setTimeout(addClass.pbind(s.moreWrap,"shown"),0)}},hide:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(!o){var t=function(){o=0,s.moreWrap&&removeClass(s.moreWrap,"shown")};if(e){var a=domByClass(s.moreWrap,"_more_items");hide(a),t(),setTimeout(show.pbind(a),0)}else o=setTimeout(t,300)}})),setOptions:function(e){extend(a,e)},setItems:function(e){for(window.tooltips&&tooltips.destroyAll(n);n.firstChild;)re(n.firstChild);var t=void 0!==a.hideAfterCount?a.hideAfterCount:4,i=void 0!==a.maxShown?a.maxShown:3,o=!1,d=a.hideItem,c=(d||e.length>t)&&(!browser.mobile||a.ignoreMobile),p=a.hideLabel||getLang("global_media_selector_more");function _(e,t,i,o,n,d){var l=ce("a",{innerHTML:o?t:'<span class="blind_label">'+t+"</span>",className:"ms_item ms_item_"+e+" _type_"+e});if(!o&&s.moreWrap?domInsertBefore(l,s.moreWrap):(o||n).appendChild(l),l.setAttribute("tabindex",0),!o){l.setAttribute("data-title",t),l.setAttribute("aria-label",t),l.setAttribute("role","link");var c=function(){showTitle(this,!1,d||!1,{noZIndex:!0})};addEvent(l,"mouseover",c),r.push((function(){removeEvent(l,"mouseover",c)}))}if(i&&!cur.viewAsBox){var p=function(){return s.activate(),s.hide(!0),a.onItemClick&&!a.onItemClick(e)||i(),!1};addEvent(l,"click",p),r.push((function(){removeEvent(l,"click",p)}))}}s.moreWrap=!1,s.lastTypes=e,each(e,(function(e,t){var u=t[0],h=t[1],g=t[2];if("article"!=u){if("postpone"===u&&z&&!s.postponeBtn){var m=getLang("wall_publication_now");s.postponeBtn=se(`<div class="post_action_btn has_cross" id="post_postpone_btn${s.id}">\n                <div class="post_action_btn_layout">\n                  <span class="post_action_btn_text" role="button" aria-label="${replaceEntities(m)}">${m}</span>\n                  <span class="post_action_image_btn _close" role="button" title="${replaceEntities(getLang("wall_post_timer_reset"))}"></span>\n                  <div class="post_action_tt_content _postpone" id="post_postpone_tt_content${s.id}" onclick="cancelEvent(event)"></div>\n                </div>\n               </div>`),a.actionsEl.appendChild(s.postponeBtn);var v="post_postpone_btn"+s.id,b=ge(v),f=geByClass1("post_action_tt_content",b),w=geByClass1("post_action_btn_layout",b),y=[-4*(vk.rtl?-1:1),4],C=new ElementTooltip(w,{appendTo:domPN(b),forceSide:"bottom",autoShow:!1,customShow:!0,cls:"_postpone timer_in_tt",noOverflow:!1,centerShift:0,offset:y,content:f,noHideOnClick:!0,align:"left",onShow:()=>{E.activeState=!0},onHide:()=>{E.activeState=!1,setTimeout(()=>{E.postponeDatepicker&&E.postponeDatepicker.hide()},ElementTooltip.FADE_SPEED)},onFirstTimeShow:function(){show(f)}});return cur["postPostponeTT"+s.id]=C,cur.destroy.push((function(){C&&C.destroy()})),addEvent(s.postponeBtn,"click",g),void r.push((function(){removeEvent(s.postponeBtn,"click",g)}))}if(u!==k){if(c&&(d?u==d:e==i)){var M=n.appendChild(ce("div",{className:"ms_items_more_wrap"})),T=function(){s.show()},I=function(e){0===e.detail&&hasClass(s.moreWrap,"shown")?s.hide():s.show()},x=function(){s.hide()};addEvent(M,"mouseenter",T),addEvent(M,"click",I),addEvent(M,"mouseleave",x),r.push((function(){removeEvent(M,"mouseenter",T),removeEvent(M,"click",I),removeEvent(M,"mouseleave",x)}));var S=p;a.vectorIcon&&(S='<span class="blind_label">'+p+"</span>",addClass(M,"ms_items_more_wrap_vector"));var P=M.appendChild(ce("a",{className:"ms_item_more",innerHTML:'<span class="ms_item_more_label">'+S+"</span>"}));P.setAttribute("tabindex",0),P.setAttribute("role","button"),P.setAttribute("aria-label",p);var A=ce("div",{className:"ms_items_more_helper"});o=ce("div",{className:"ms_items_more _more_items"}),A.appendChild(o),M.appendChild(A),s.moreWrap=M}_(u,h,g,o,n)}}else Object(l.isArticleEditorAvailable)()&&_(u,h,g,!1,n,[6,8])}))},enqueueOnAddMediaInit(e){},onAddMediaInit(e){}};t&&s.setItems(t),browser.msie&&(removeEvent(e,"MSPointerDown"),addEvent(e,"MSPointerDown",s.activate.pbind(!0)));removeEvent(e,"mouseover"),addEvent(e,"mouseover click",s.activate),a.global||cur.destroy.push((function(){removeEvent(e,"mouseover click",s.activate)}));a.forceToUp&&addClass(geByClass1("ms_items_more_wrap",n),"to_up");return s.handlersToClean=r,s}(e,$,{onActivate:function(){cur.attachCount=E.attachCount,cur.chooseMedia=E.chooseMedia,cur.getFrom=E.getFrom,cur.hasChosenMedia=E.hasChosenMedia,cur.lastAddMedia=E,cur.onMediaUploadStarted=b.onMediaUploadStarted,cur.showMediaProgress=E.showMediaProgress,cur.unchooseMedia=E.unchooseMedia,cur.updateChosenMedia=E.updateChosenMedia},onItemClick:function(e){return!(j&&E.attachCount()>=N&&"postpone"!==e&&"mark_as_ads"!==e&&"copyright"!==e)||(vk.widget?showBox("blank.php",{code:1900,limit:N}):Object(o.showFastBox)(getLang("global_error"),getLang("attachments_limit",N)),!1)},hideAfterCount:b.hideAfterCount,topOffset:b.topOffset,forceUp:b.forceUp,global:b.global,maxShown:b.maxShown,forceToUp:b.forceToUp,vectorIcon:b.vectorIcon,ignoreMobile:b.ignoreMobile,actionsEl:B,hideLabel:b.hideLabel});if(q){var V=intval(q.id);if(j){t.innerHTML=`<div id="page_pics_preview${V}" class="page_pics_preview media_preview clear_fix"></div><div id="page_dpics_preview${V}" class="page_pics_preview post_thumbed_media page_media_sortable media_preview clear_fix"></div><div id="page_docs_preview${V}" class="page_docs_preview post_thumbed_media page_media_sortable media_preview clear_fix"></div><div id="page_pdocs_preview${V}" class="page_docs_preview media_preview clear_fix"></div><div id="page_ldocs_preview${V}" class="page_docs_preview media_preview clear_fix"></div><div id="page_adocs_preview${V}" class="page_docs_preview media_preview clear_fix"></div><div id="page_mpics_preview${V}" class="page_pics_preview media_preview clear_fix"></div><div id="page_ppdocs_preview${V}" class="page_docs_preview media_preview _page_ppdocs_preview clear_fix"></div><div id="page_progress_preview${V}" class="page_progress_preview media_preview clear_fix"></div>`;var F=domFC(t),H=domNS(F),W=domNS(H),G=domNS(W),Y=domNS(G),K=domNS(Y),X=domNS(K),J=domNS(X),Q=domNS(J);removeClass(t,"media_preview"),removeClass(Y,"vk_mini_app_preview"),removeClass(Y,"vk_mini_app_preview_fixed"),addClass(t,"multi_media_preview")}else addClass(t,"med_no_attach"),show(t);return z&&(J=ge("post_postpone_tt_content"+V)),(E={_addMediaLink:e,lnkId:V,menu:q,types:$,phLists:{},handlers:{},postponeIsTooltip:z,chosenMedias:[],limit:N,emitter:new h.default,eventTypes:{mediaUpdate:"mediaUpdate"},_showAddMedia:function(){q.show()},_hideAddMedia:function(e){q.hide(e)},hasRestrictingAttach:function(){return geByClass1("medadd_c_story",W)},getFrom:()=>O,updateChosenMedia:function(e,t,a){E.chooseMedia(e,t,a,null,null,null,!0)},addOrUpdateChosenMedia(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var i=t[0],o=t[1];return(E.hasChosenMedia(i,o)?E.updateChosenMedia.bind(E):E.chooseMedia.bind(E))(...t)},hasChosenMedia:function(e,t){var a=!1;return each(E.chosenMedias,(function(){if(this[0]===e&&this[1]===t)return a=!0,!1})),a},chooseMedia:function(a,i,o,n,r,s,l){if(!cur.articleEditorLayer||"article"===a||"poll"===a){if(vk.widget&&(i=clean(i)),"postpone"===a&&z){if(hasClass(E.menu.postponeBtn,"on"))return!1;addClass(E.menu.postponeBtn,"on")}if(b.poster&&b.poster.isOpen()&&"postpone"!==a&&a!==k&&"copyright"!==a&&"situational_theme"!==a&&b.poster.closeEditor(),E.onChange&&!1===E.onChange(a,i,o,n))return void 0!==o.upload_ind&&re("upload"+o.upload_ind+"_progress_wrap"),!1;if("note"===a&&(cur.pbNoteAdded=!1),inArray(a,b.disabledTypes||[]))return!1;if((E.attachCount()>=N&&void 0===o.upload_ind&&"postpone"!==a&&a!==k&&"situational_theme"!==a&&"mark_as_ads"!==a||E.hasRestrictingAttach())&&"copyright"!==a){if(j)return!1;E.unchooseMedia()}var p=!1,u={},h=null;if(j&&(each(E.chosenMedias,(function(e){if(h=e,this[0]==a&&this[1]==i)return p=!0,!1;u[this[0]]=u[this[0]]?u[this[0]]+1:1})),p&&!l||l&&!p))return!1;var g,m,f="",y="",C=!1,M=W,T="",I="",x=!1,S="";switch(a){case"graffiti":if(u.pretty_cards)return!1;isObject(o)||(o={thumb:o||""}),f=`<div class="fl_l page_preview_graffiti"><img class="page_preview_graffiti" src="${(o=Ke(o)).thumb}" /></div>`,M=C=X;break;case"photos_list":if(vk.widget||u.pretty_cards)return!1;hide(this._addMediaLink),vkImage().src=o[1],(A=o[3].replace(/^{|}$/g,""))&&(A+=","),A+='"queue":1';var P=o[5];P&&P.restrictionBlur&&(S+=" PostPhotoRestriction--blur PostPhotoRestriction--photosList PostPhotoRestriction--smallIcon"),P&&P.restrictionGeo&&(S+=" PostPhotoRestriction--geo PostPhotoRestriction--photosList PostPhotoRestriction--smallIcon"),f=`<div${b.nocl?"":` onclick="return showPhoto('${o[4]}', '${o[2]}', '${clean(A)});"`} class="fl_l page_preview_photo${S}"><img class="page_preview_photo" src="${o[1]}" /></div>`,M=C=F;break;case"photo":if(u.pretty_cards)return!1;isObject(o)||(o={thumb_m:o[0]||"",thumb_s:o[1]||"",list:o[2]||"",view_opts:o[3]||"",upload_ind:o.upload_ind||void 0}),o=Ke(o),vkImage().src=o.thumb_m;var A=o.view_opts.replace(/^{|}$/g,"");if(vk.widget&&(A=A.replace(/&quot;/g,'"')),A&&(A+=","),A+='"queue":1',E.phLists[i]=o.list,U){if(!o.editable)return!1;if(!b.nocl){var D="{"+A+"}";D=JSON.parse(D),o.editable.click=E.showPhoto.pbind(i,o.list,D)}}var B=parseJSON(o.view_opts);S="",B.temp&&B.temp.restrictionGeo&&(S+=" PostPhotoRestriction--geo"),B.temp&&B.temp.restrictionBlur&&(S+=" PostPhotoRestriction--blur"),f=`<div ${b.nocl?"":` onclick="return cur.addMedia[${E.lnkId}].showPhoto('${i}', '${o.list}', {${clean(A)}});"`} class="fl_l page_preview_photo${s?" page_preview_ph_graff":""}${S}"><img class="page_preview_photo" src="${o.thumb_m}" /></div>`,C=1,M=F;break;case"video":if(isEmpty(o)||u.pretty_cards)return!1;if(isObject(o)||(o={thumb:o||""}),U){if(!o.editable)return!1;b.nocl||(o.editable.click=showVideo.pbind(i,o.list_id,{queue:1,autoplay:1}))}(o=Ke(o)).preview&&!vk.widget?(f=o.preview,o.editable.preview=f):f=`\n              <div ${b.nocl?"":`onclick="return showVideo('${i}', '${o.list_id}', {queue:1,autoplay:1});"`} class="fl_l page_preview_video">\n                <img class="page_preview_video" src="${o.thumb}" />\n              </div>\n            `,C=1,M=F,m=o.list_id;break;case"donut_link":if(!o||u.donut_link)return!1;f='<div class="medadd_h medadd_h_pretty_cards inl_bl">'+getLang("groups_donut_snippet_link_title")+"</div>",y=o.snippet_html;break;case"article":if(vk.widget||u.article||u.page||u.pretty_cards||!o)return!1;f='<div class="medadd_h medadd_h_pretty_cards inl_bl">'+getLang("global_article")+"</div>",y=o.snippet_html,i=o.url,o.rev&&(i+="?rev="+o.rev),M=Y;break;case"audio":if(u.pretty_cards)return!1;o=Ke(o),f=Page.addAudioPreview(clean(i),o),T=` id="pam${V}_audio${clean(i)}"`;break;case"audio_playlist":if(u.audio_playlist)return!1;(o=Ke(o)).id=intval(o.id),o.ownerId=intval(o.ownerId),vk.widget&&o.authorHref&&!o.authorHref.match(/^(https?:\/\/|\/)/)&&(o.authorHref="https://"+o.authorHref),vk.widget&&o.coverUrl&&!o.coverUrl.match(/^(https?:\/\/|\/)/)&&(o.coverUrl="https://"+o.coverUrl);var $=o.coverUrl?`background-image:url('${o.coverUrl}'); background-size: cover;`:"",L="";L=o.authorHref?`<a href="${o.authorHref}" onclick="return nav.go(this)">${o.authorName}</a>`:o.authorName;var O="'"+(o.accessHash||"")+"'";y='<div class="audio_pl_attach_preview _audio_pl _audio_pl_'+o.ownerId+"_"+o.id+' clear_fix"><div class="audio_pl_attach_preview__play" onclick="return getAudioPlayer().playPlaylist('+o.ownerId+", "+o.id+", "+O+')"></div><div class="audio_pl_attach_preview__cover" style="'+$+'">'+(o.gridCovers||"")+'</div><div class="audio_pl_attach_preview__title">'+o.title+'</div><div class="audio_pl_attach_preview__info_line">'+L+"</div></div>",f='<span class="medadd_h">'+getLang("global_audio_playlist")+"</span>",M=Y;break;case"artist":if(u.artist)return!1;var Q=o.coverUrl?`background-image:url('${o.coverUrl}');`:"",Z="",ee="";o.blockId&&(Z=`<div class="MusicAuthorSnippet__play" onclick="return getAudioPlayer().playBlock('${o.ownerId}', 'artist${o.blockId}', '', '', 'artist')">${getLang("audio_listen_snippet")}</div>`,ee="_audio_pl _audio_pl_${data.ownerId}_artist${data.blockId}"),y=`<div class="MusicAuthor_attach_preview _MusicAuthor ${ee} clear_fix">\n              <div class="MusicAuthorSnippet__cover" style="${Q}"></div>\n              <div class="MusicAuthorSnippet__info">\n                ${Z}\n                <div class="MusicAuthorSnippet__title">${o.title}</div>\n                <div class="MusicAuthorSnippet__subtitle">${getLang("global_artist")}</div>\n              </div>\n            </div>`,f='<span class="medadd_h">'+getLang("global_artist")+"</span>",M=Y;break;case"curator":if(u.curator)return!1;var te="",ae="",ie=o.coverUrl?`background-image:url('${o.coverUrl}');`:"";o.blockId&&(te=`<div class="MusicAuthorSnippet__play" onclick="return getAudioPlayer().playBlock('${o.ownerId}', '${o.blockId}', '', '', 'curator')">${getLang("audio_listen_snippet")}</div>`,ae="_audio_pl _audio_pl_${data.ownerId}_curator${data.blockId}"),y=`<div class="MusicAuthor_attach_preview _MusicAuthor ${ae} clear_fix">\n              <div class="MusicAuthorSnippet__cover" style="${ie}"></div>\n              <div class="MusicAuthorSnippet__info">\n                ${te}\n                <div class="MusicAuthorSnippet__title">${o.title}</div>\n                <div class="MusicAuthorSnippet__subtitle">${getLang("global_curator")}</div>\n              </div>\n            </div>`,f='<span class="medadd_h">'+getLang("global_curator")+"</span>",M=Y;break;case"doc":if(vk.widget||u.pretty_cards)return!1;if(o.editable){var oe="stopEvent(event);";(o=Ke(o)).hasBox&&(o.editable.click=e=>{Page.showGifBox(o.id,o.ownerId,intval(o.postId),intval(o.postOwnerId),o.hash,e)},oe=`Page.showGifBox(${intval(o.id)}, ${intval(o.ownerId)}, ${intval(o.postId)}, ${intval(o.postOwnerId)}, '${o.hash}', event);`),I+=" page_preview_doc_as_photo_wrap";var ne=v(o.editable.sizes.m||o.editable.sizes.s,1)[0];f=`<a href="${o.editable.href}" onclick="${b.nocl?"":oe}" class="page_preview_doc_as_photo" target="_blank" rel="noopener" style="background-image: url('${ne}');"><img class="page_preview_doc_as_photo" src="${ne}" />${o.editable.label}</a>`,C=1,M=F}else o.thumb&&o.thumb_s?(f="gif"==o.ext?'<a onclick="if (cur.cancelClick) return (cur.cancelClick = false);" target="_blank" rel="noopener" href="'+o.href+'" class="pam_dpic"><div class="page_preview_doc_photo"><img src="'+o.thumb+'" align="center" /></div><div class="page_preview_doc_photo_hint doc_gif">'+o.title+"</div>":'<a onclick="if (cur.cancelClick) return (cur.cancelClick = false);" target="_blank" rel="noopener" href="'+o.href+'" class="pam_dpic"><div class="page_preview_doc_photo"><img src="'+o.thumb+'" align="center" /></div><div class="page_preview_doc_photo_hint">'+o.title+"</div>",y='</a><div class="pam_bg"></div>',M=C=H,T=' id="pam'+V+"_doc"+i+'"'):(f="",y='<div class="page_doc_row"><a target="_blank" rel="noopener" href="'+o.href+'" class="page_doc_icon page_doc_icon'+intval(o.type)+'"></a><a target="_blank" href="'+o.href+'" class="page_doc_title">'+o.title+'</a><div class="page_doc_description_row"><div class="page_doc_size">'+o.size_str+"</div></div></div>",T=' id="pam'+V+"_doc"+i+'"');break;case"story":if(vk.widget||u.pretty_cards)return!1;f='<div class="medadd_c_story"><a target="_blank" rel="noopener" '+o.attr+'"><div class="medadd_c_story_thumb fl_l" style="background-image:url('+o.thumb+')"></div></a><div class="medadd_c_story_info fl_l"><a class="medadd_c_story_title" target="_blank" '+o.attr+'">'+o.title+'</a><div class="medadd_c_story_desc">'+o.date_string+"</div></div>",hide(e);break;case"narrative":if(u.narrative)return!1;f='<span class="medadd_h">'+getLang("global_type_narrative")+"</span>",y=o.snippet_html;break;case"mask":if(vk.widget||u.pretty_cards)return!1;f='<div class="medadd_c_mask"><div class="medadd_c_story_thumb fl_l" style="background-image:url(/images/landings/vkmasks/masksSnippet_2x.png)"></div></a><div class="medadd_c_story_info fl_l"><div class="medadd_c_story_title">'+o.share.title+'</div><div class="medadd_c_story_desc">'+o.share.desc+"</div></div>";break;case"share":if(u.share||u.page||u.pretty_cards||u.market||!o.lang)return!1;if(isArray(o)&&(o={domain:o[0],url:o[1],initialPattern:o[2],title:o[3],description:o[4],images:[o[5]],user_id:o[6],photo_id:o[7]}),x=o.is_vk_mini_app,o.draft){var de={onSuccess:o.onSuccess,onError:o.onError};return E.checkURL(o.url,void 0,o.checkUrlAdditionalParams||{},de),!1}if(!o.title&&!(cur.options.share||{}).allow_preview_empty_links)return(o.onError||function(){})(),!1;if(x?(o.title=Object(d.unclean)((o.title||"").replace(/\n/g,"\\n")),o.description=Object(d.unclean)((o.description||"").replace(/\n/g,"\\n"))):(o.title=Object(d.unclean)((o.title||"").replace(/<br>/g,"\n")),o.description=Object(d.unclean)((o.description||"").replace(/<br>/g,"\n")),o.description_short=Object(d.unclean)((o.description_short||"").replace(/<br>/g,"\n")),o.description_narrow=Object(d.unclean)((o.description_narrow||"").replace(/<br>/g,"\n"))),cur.options=cur.options||{},cur.options.share&&cur.options.share.max_title_len&&(o.title=(o.title||"").substr(0,cur.options.share.max_title_len)),cur.options.share&&cur.options.share.max_desc_len&&(o.description=(o.description||"").substr(0,cur.options.share.max_desc_len),o.description_short=(o.description_short||"").substr(0,cur.options.share.max_desc_len),o.description_narrow=(o.description_narrow||"").substr(0,cur.options.share.max_desc_len)),o.media=o.media||i,o.lang&&(cur.lang=extend(cur.lang||{},o.lang)),o=Ke(o),f='<a target="_blank" rel="noopener" href="/away.php?to='+encodeURIComponent(o.url)+'" class="medadd_h medadd_h_link inl_bl">'+clean(Object(d.unclean)(o.is_vk_mini_app?o.lang.global_vk_mini_app:o.lang.profile_choose_link))+"</a>",x){var le="vk_mini_app_preview";Object(c.partConfigEnabled)("mini_apps_web_fixed_snippet_subtitle")&&(le+=" vk_mini_app_preview_fixed"),addClass(Y,le)}if(!o.prometheus&&!o.verification&&o.map_data){var pe=Xe(Y),_e="";_e=o.map_data[3]?o.map_data[3].replace("size=0,0","size="+pe.width+","+pe.height):"/maps?lat="+floatval(o.map_data[0])+"&lng="+floatval(o.map_data[1])+"&z=11&"+(window.isRetina()?"w="+2*pe.width+"&h="+2*pe.height:"w="+pe.width+"&h="+pe.height);var ue="";Object(c.partConfigEnabled)("maps_no_referrer")&&(ue='referrerpolicy="no-referrer"'),f+=`<div class="medadd_c_share_map"><a onclick="return showBox('al_places.php', {act: 'geo_box', lat: ${floatval(o.map_data[0])}, long: ${floatval(o.map_data[1])}, provider: ${intval(o.map_data[3])}}, {dark: 1});"><div class="page_media_map_point"></div><img class="page_preview_map" ${ue} width="${pe.width}" height="${pe.height}" src="${_e}" /></a></div>`}if(E.shareData=extend(E.shareData||{},o,{imagesStyles:[""]}),M=Y,(o.onSuccess||function(){})(),(cur.options.share||{}).button_exclusive&&o.shareButtons)hide(e),(he=ge("signed"))&&disable(he);hide(domByClass(q.menuNode,"_type_share")),hide(domByClass(q.menuNode,"_type_market"));break;case"pretty_cards":if(u.share||u.pretty_cards||vk.widget)return!1;var he;f='<div class="medadd_h medadd_h_pretty_cards inl_bl">'+o.lang.global_wall_pretty_cards+"</div>",(he=ge("signed"))&&disable(he),hide(domByClass(q.menuNode,"_type_pretty_cards")),hide(e),M=Y;break;case"poll":if(!o.lang||vk.vidget||u.poll||!G||u.pretty_cards)return!1;hide(domByClass(q.menuNode,"_type_poll")),M=G;break;case"map":if(vk.widget||u.pretty_cards)return!1;var me=Xe(X);ue="";Object(c.partConfigEnabled)("maps_no_referrer")&&(ue='referrerpolicy="no-referrer"'),f=`<span class="medadd_h medadd_h_link inl_bl">${clean(Object(d.unclean)(o[4]))}</span><div class="fl_l medadd_c_map"><a onclick="return showBox('al_places.php', {act: 'geo_box', lat: ${floatval(o[0])}, long: ${floatval(o[1])}, provider: ${intval(o[3])}}, {dark: 1});"><div class="page_media_map_point"></div><img class="page_preview_map" ${ue} width="${me.width}" height="${me.height}" src="/maps?lat=${floatval(o[0])}&lng=${floatval(o[1])}&z=11&w=${me.width}&h=${me.height}" /></a></div>`,M=C=X,hide(domByClass(q.menuNode,"_type_map"));break;case"page":if(u.share||u.page||!o.lang||vk.widget||u.pretty_cards)return!1;var ve=o.media.split("_");f='<a href="/page'+o.media+'" onclick="return showWiki({oid: '+ve[0]+", id: "+ve[1]+'}, false, event, {queue: 1})" class="medadd_h medadd_h_page inl_bl">'+o.lang.profile_choose_page+"</a>",M=Y;break;case"album":if(vk.widget||u.pretty_cards)return!1;if(o.is_private_album){extend(o.editable,{title:o.title,size:0}),C=1,M=F;break}if(o.thumb.match(/^\/images\//)&&(o.thumb=""),U){if(!o.editable)return!1;extend(o.editable,{title:o.title,size:o.count,click:!b.nocl&&nav.change.pbind({z:"album"+i})})}var be=o.thumb;vkImage().src=be,f=`<a class="${"fl_l page_album_link"+(be?"":" page_album_nocover")}" ${g=b.nocl?"":' href="/album'+i+'" onclick="return nav.change({z: \'album'+i+"'}, event)\""}>\n              ${be?`<div class="page_album_thumb_wrap"><img class="page_album_thumb" src="${be}"/></div>`:""}\n              <div class="page_album_title">\n                <div class="page_album_size">${o.count}</div>\n                <div class="page_album_title_text">${o.title}</div>\n              </div>\n            </a>`,C=1,M=F;break;case"note":if(!o.lang||vk.widget||u.pretty_cards)return!1;f="<a onclick=\"showWiki({w: 'note"+o.raw+'\', edit: 1}, true, event, {queue: 1})" class="medadd_h medadd_h_note inl_bl">'+o.lang.profile_choose_note+"</a>",y='<div class="medadd_c medadd_c_note"><a onclick="showWiki({w: \'note'+o.raw+'\', edit: 1}, true, event, {queue: 1})" id="share_note_title'+o.raw+'">'+o.title+"</a></div>",M=Y;break;case"market":if(vk.widget||u.pretty_cards||u.share||u.market||u.market_services)return!1;var fe="";o.thumb&&(fe='<a target="_blank" rel="noopener" href="'+o.href+'"><img class="medadd_c_market_thumb fl_l" src="'+o.thumb+'" /></a>'),f='<div class="medadd_c_market">'+fe+'<div class="medadd_c_market_info fl_l"><a class="medadd_c_market_title" target="_blank" href="'+o.href+'">'+o.title+'</a><div class="medadd_c_market_price">'+o.price+"</div></div>",hide(domByClass(q.menuNode,"_type_market")),hide(domByClass(q.menuNode,"_type_market_services"));break;case"market_album":if(vk.widget||u.pretty_cards)return!1;if(o.is_private_album){extend(o.editable,{title:o.title,msize:""}),C=1,M=F;break}if(U){if(!o.editable)return!1;extend(o.editable,{title:o.title,msize:langNumeric(o.count,o.lang.profile_X_market_items),click:!1})}ve=i.split("_");vkImage().src=o.thumb,g=b.nocl?"":' href="/market'+ve[0]+"?section=album_"+ve[1]+'"',f=`<a class="${"fl_l page_preview_album wall_album_cover_wrap wall_market_album_cover"+(o.thumb?"":" page_album_nocover")}" ${g}>\n              ${o.thumb?`<img class="wall_album_cover" src="${o.thumb}"/>`:""}\n              <div class="wall_album_caption">\n                <div class="wall_album_title_wrap clear_fix">\n                  <div class="wall_album_count fl_r">${o.count}</div>\n                  <div class="wall_album_title">${o.title}</div>\n                </div>\n              </div>\n            </a>`,C=1,M=F;break;case"copyright":if(vk.widget)return!1;E.copyrightCreate(o);break;case"postpone":if(vk.widget)return!1;var we="";if(cur.editingPost&&!j)i=intval(i),o.date=i||intval(cur.editingPost[7]),ge("wpe_save").innerHTML=getLang("global_save"),we=getLang("global_save");else if(cur.editingPost&&"wpe_media_preview"==t.id){i=intval(i),o.date=i||intval(cur.editingPost[7]);var ke=geByClass1("medadd_c_timersett",J);if(ke){var ye=domPN(ke);ke=ye.innerHTML,re(ye)}else ke="";ge("wpe_save").innerHTML=getLang("global_save"),we=getLang("global_save")}else{o.draft?o.date=intval(i):cur.postponedLastDate&&(o.date=intval(cur.postponedLastDate)+3600);var Ce=ge("official");if(!(Ne=gpeByClass("_submit_post_box",Ce))&&b.poster&&domClosest("poster",Ce)&&(Ne=ge("submit_post_box")),Ce&&Ne){var Me=domData(Ne,"from-oid"),Te=domData(Ne,"oid");Me==vk.id&&Te&&wall.setReplyAsGroup(Ce,{from:Te}),disable(Ce);var Ie=window.data(Ce,"tt");if(Ie&&Ie.rdBtns){var xe=Ie.rdBtns[1],Se=Ie.rdBtnsGroup,Pe=domData(xe,"as");radiobtn(xe,Pe,Se)}}(xe=ge("send_post"))&&(xe.innerHTML=o.lang.profile_wall_postpone_btn,we=o.lang.profile_wall_postpone_btn)}z?(E.updatePostponeBtnText(!1,o.date),E.postponeDate=o.date):f=`<div class="medadd_h medadd_h_timer inl_bl">${o.lang.profile_choose_timer}<span id="postpone_preview${V}"></span></div>`,!E.postponeDatepicker&&z&&E.setupPostpone(o,ke),b.poster&&b.poster.changeBtnText(we);var Ae=Math.round((new Date).getTime()/1e3);intval(o.date)<Ae&&(o.date=Ae+3600),hide(domByClass(q.menuNode,"_type_postpone")),M=J;break;case k:if(vk.widget)return!1;break;case"mark_as_ads":if(vk.widget)return!1;f='<div class="medadd_h medadd_h_mark_as_ads inl_bl">'+o.lang.global_ads_wall_post_mark_as_ads_action+"</div>",hide(domByClass(q.menuNode,"_type_mark_as_ads")),M=J;break;case"wall":if(vk.widget||u.pretty_cards)return!1;f='<div class="medadd_c_wall"><a target="_blank" rel="noopener" href="'+o.href+'"><img class="medadd_c_wall_thumb fl_l" src="'+o.thumb+'" /></a><div class="medadd_c_wall_info fl_l"><a class="medadd_c_wall_author" target="_blank" href="'+o.href+'">'+o.author+'</a><div class="medadd_c_wall_type">'+o.lang.title+"</div></div>",T=' id="pam'+V+"_wall"+i+'"',hide(e);break;case"wall_reply":if(vk.widget||u.pretty_cards)return!1;f='<div class="medadd_c_wall"><a target="_blank" rel="noopener" href="'+o.href+'"><img class="medadd_c_wall_thumb fl_l" src="'+o.thumb+'" /></a><div class="medadd_c_wall_info fl_l"><a class="medadd_c_wall_author" target="_blank" href="'+o.href+'">'+o.author+'</a><div class="medadd_c_wall_type">'+o.lang.title+"</div></div>",T=' id="pam'+V+"_wall_reply"+i+'"',hide(e);break;case"podcast":if(vk.widget||u.pretty_cards)return!1;var De="_im_media_preview"===domPN(M).id,Be=!De&&cur.editingPost&&"wpe_media_preview"===domPN(M).id;if(De)f='<div class="medadd_c_podcast"><a target="_blank" rel="noopener" href="'+o.href+'"><img class="medadd_c_podcast_thumb fl_l" src="'+o.thumb+'" /></a><div class="medadd_c_podcast_info fl_l"><a class="medadd_c_podcast_title" target="_blank" href="'+o.href+'">'+o.title+'</a><div class="medadd_c_podcast_type">'+o.lang.title+"</div></div>";else{var Ee=!1;each(E.chosenMedias||[],(function(e,t){isArray(t)&&"podcast"===t[0]&&(cur.addMedia[E.lnkId].unchooseMedia(e),Ee=!0)})),Ee&&E.onChange&&E.onChange(a,i,o,n),f='<div class="podcast_preview_title">'+getLang("audio_podcast_attach_media")+"</div>";var $e=o.audio[AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+o.audio[AudioUtils.AUDIO_ITEM_INDEX_ID];cur.podcastEditData={audioId:$e,ref:"post",onCreate:function(e,t){E.chooseMedia("podcast",e[AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+e[AudioUtils.AUDIO_ITEM_INDEX_ID],{audio:e,coverUrl:t})}};var Le="<span class=\"podcast_snippet__edit\" onclick=\"cur.chooseMedia = cur.podcastEditData.chooseMedia; stManager.add([jsc('web/podcast.js')], function() { Podcast.edit('"+$e+"'); });\"></span>";f+='<div class="podcast_snippet_loading" id="podcast_loading'+i[0]+'"></div>',stManager.add([jsc("web/podcast.js")],(function(){domReplaceEl(ge("podcast_loading"+i[0]),Podcast.drawSnippet(o.audio,o.coverUrl,Le))}),!0)}if(M=K,(o.onSuccess||function(){})(),hide(domByClass(q.menuNode,"_type_podcast")),!De&&!Be){var Oe=ge("official"),Ne=Oe&&gpeByClass("_submit_post_box",Oe);if(Oe&&Ne)(Me=domData(Ne,"from-oid"))!==(Te=domData(Ne,"oid"))&&(I=" attach_disabled")}break;case w:if(vk.widget||u.pretty_cards||u[w])return!1;var je="",Ue=Number(o.type);if(Ue===_.GROUPS_CLASS_EVENT&&(je=o.private?getTemplate("event_snippet_private_info"):""),!(f=getTemplate("event_snippet",extend({bottom:je},o))))return(o.onError||function(){})(),!1;f='<div class="event_preview_title">'+(Ue===_.GROUPS_CLASS_EVENT?getLang("events_media_type"):getLang("groups_media_type_community"))+"</div>"+f,M=Y,(o.onSuccess||function(){})();break;case"textlive":if(u.textlive)return!1;f=getTemplate("textlive_snippet",o);break;case"situational_theme":if(u.situational_theme)return!1}if(j){var Re=E.chosenMedias,ze=p?h:Re.length,qe="";if(U&&1===C)qe=!1;else if("photos_list"===a)qe=se('<div class="page_preview_'+a+"_wrap"+I+'" style="position: relative">'+f+'<div class="page_photos_count">'+i.split(",").length+"</div></div>");else if("postpone"==a&&z||"copyright"===a||a===k||"situational_theme"===a)qe=!1;else{var Ve=null;"share"===a&&o.map_data&&(Ve="map"),qe=se('<div class="page_preview_'+(Ve||a)+"_wrap"+I+(x?" page_preview_vk_mini_app":"")+'"'+(b.nocl?' style="cursor: default"':"")+T+'><div nosorthandle="1" class="page_media_x_wrap inl_bl" data-title="'+getLang("dont_attach")+'" aria-label="'+getLang("dont_attach")+'" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia['+E.lnkId+"].unchooseMedia("+ze+'); return cancelEvent(event);"><div class="page_media_x" nosorthandle="1"></div></div>'+f+y+"</div>")}if(addClass(qe,C?"fl_l":"clear_fix"),void 0!==o.upload_ind&&re("upload"+o.upload_ind+"_progress_wrap"),b.toggleLnk&&!p){var Fe=E.attachCount()+1<N;toggle(e,Fe),b.onToggleBlock&&b.onToggleBlock(Fe)}U&&1===C?(addClass(M,"editable_thumbs_wrap"),M=domLC(M)&&hasClass(domLC(M),"editable_thumbs")?domLC(M):M.appendChild(ce("div",{id:"thumbs_edit"+V,className:"editable_thumbs"})),stManager.add(["thumbs_edit.css",jsc("web/thumbs_edit.js")],()=>{if(Re[ze]&&(Re[ze].type===a||Re[ze].media!==i)){if(b.toggleLnk&&!p){var n=E.attachCount()+1<N;toggle(e,n),b.onToggleBlock&&b.onToggleBlock(n)}o.editable.remove=E.unchooseMedia.pbind(ze),show(domPN(M));var r=ThumbsEdit.convert(a,i,o.editable);domData(M,"te-inited")?p?ThumbsEdit.updateMedia(M,a,i,o):ThumbsEdit.addMedia(M,r):ThumbsEdit.init(M,[r],{width:b.teWidth,height:b.teHeight,nocl:b.nocl,force:!0,onMove:b.onAddMediaChange,onUpdate:b.onChangedSize,deferred:!0}),toggleClass(t,"media_preview_has_medias",E.hasVisibleRows()&&(hasClass(t,"reply_media_preview")||isVisible(e)||!hasClass("signed","disabled"))),b.onChangedSize&&b.onChangedSize()}},!0)):(("postpone"==a||"copyright"==a||a===k)&&z||"situational_theme"===a||(show(M),p?M.replaceChild(qe,Re[h][2]):M.appendChild(qe)),R&&(M==W?stManager.add([jsc("web/sorter.js")],(function(){var e=getXY(W),t=getSize(W),a=function(){W.sorter?sorter.added(W):M.childNodes.length>1&&sorter.init(W,{onReorder:b.onAddMediaChange})};e[0]||e[1]||t[0]||t[1]?a():cur.sorterClbk=a,b.onChangedSize&&b.onChangedSize()}),!0):M==H&&stManager.add([jsc("web/qsorter.js")],(function(){H.qsorter?qsorter.added(H):M.childNodes.length>1&&qsorter.init(H,E.qsorterOpts()),b.onChangedSize&&b.onChangedSize()}),!0)),b.onChangedSize&&b.onChangedSize()),p?Re[h]=[a,i,qe,n,m,o]:Re.push([a,i,qe,n,m,o])}else{ze=0;if("postpone"===a?ze=1:"mark_as_ads"===a&&(ze=2),"postpone"==a&&z||"copyright"===a||a===k||"situational_theme"===a)qe=!1;else{var He=(!1===C?"page_docs_preview":"page_pics_preview")+(ze?"":" post_thumbed_media");He+=C?" fl_l":" clear_fix";var We=null;"share"===a&&o.map_data&&(We="map"),qe=se(`\n            <div class="${He}">\n              <div class="${"page_preview_"+(We||a)+"_wrap"} ${I}" ${(b.nocl?'style="cursor: default"':"")+T}>\n                ${f}\n                <div nosorthandle="1" class="page_media_x_wrap inl_bl" data-title="${getLang("dont_attach")}" aria-label="${getLang("dont_attach")}" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia[${E.lnkId}].unchooseMedia(${ze}); return cancelEvent(event);">\n                  <div class="page_media_x" nosorthandle="1"></div>\n                </div>\n                ${y}\n              </div>\n            </div>`)}void 0!==o.upload_ind&&re("upload"+o.upload_ind+"_progress_wrap"),"postpone"!==a&&a!==k&&"mark_as_ads"!==a&&"copyright"!==a&&(E.chosenMedia=[a,i],E.chosenMedia[5]=o,E.chosenMediaData=o),E.singleAdded(qe,a)}"share"==a?!o.title||n||o.url?o.video?(cur.shareShowImg=0,E.bigLink=!0,E.showExternalPreview()):E.showExternalPreview():(cur.shareShowImg=0,E.showPreview(!0),E.shareData.images=!1):"page"==a?o.nopreview||(cur.shareShowImg=0,E.shareData=extend(E.shareData||{},o,{images:!1}),E.showPreview()):"poll"===a?E.pollCreate(o):"postpone"==a?z?E.postponeInd=ze:E.setupPostpone(o,ke):"mark_as_ads"==a?E.markAsAds=1:"pretty_cards"==a&&E.createPrettyCards(o),toggleClass(t,"media_preview_has_medias",E.hasVisibleRows()&&(isVisible(e)||!hasClass("signed","disabled"))),b.onChangedSize&&b.onChangedSize();var Ge=window.event;return Ge&&"click"==Ge.type&&(Ge.ctrlKey||Ge.metaKey||Ge.shiftKey)&&E.attachCount()+1<=N&&(r=!0),cur.fileApiUploadStarted&&void 0!==o.upload_ind||o.upload_new||cur.preventBoxHideWithSharedBox||cur.preventBoxHide||!0===r||inArray(a,["poll","share","page","postpone","mark_as_ads","pretty_cards","copyright"])||boxQueue.hideLast(),cur.lastPostMsg=!1,b.onMediaAdd&&b.onMediaAdd(),getAudioPlayer().updateCurrentPlaying(),cur.onMediaChanged&&cur.onMediaChanged(E.chosenMedias),window.mvcur&&mvcur.onMediaChanged&&mvcur.onMediaChanged(),b.onMediaChanged&&b.onMediaChanged(),E.emitter&&E.emitter.emit(E.eventTypes.mediaUpdate),void 0!==o.upload_ind&&delete o.upload_ind,!1}function Ye(e,t){return isString(e)?e=clean(Object(d.unclean)(Object(d.unclean)(e))):(isObject(e)||isArray(e))&&(e=Ke(e,t)),e}function Ke(e,t){if(!vk.widget)return e;if((t=positive(t))>5)return e;if(isArray(e))e.forEach((function(a,i){e[i]=Ye(a,t+1)}));else if(isObject(e))for(var a in e)e.hasOwnProperty(a)&&(e[a]=Ye(e[a],t+1));return e}function Xe(e){var t=340,a=127;return"im"!==cur.module&&(t=Math.min(parseInt(e.parentElement.offsetWidth),510)||480,a=Math.min(t/2,200),(hasClass(e.parentElement,"reply_media_preview")||"wpe_media_preview"===e.parentElement.id)&&a>120&&(a=120)),{width:t,height:a}}},unchooseMedia:function(a,i){if(E.onChange&&!1===E.onChange(!1,a))return!1;if(j){if(cur.checkURLDomainRequest&&cur.checkURLDomainRequest.abort(),clearTimeout(cur.showLoaderTimeout),clearInterval(cur.shareImgInterval),clearTimeout(cur.shareImgInterval2),clearTimeout(cur.imgLoadTimeout),clearTimeout(cur.checkURLDomainTO),void 0===a){if(window.ThumbsEdit&&ThumbsEdit.removeAll("thumbs_edit"+V),each(E.chosenMedias,(function(e,t){!t||void 0===e||i&&!inArray(t[0],i)||E.unchooseMedia(e)})),E.urlsCancelled=[],b.onChangedSize){b.onChangedSize();var o=setInterval(b.onChangedSize,50);setTimeout(clearTimeout.bind(null,o),500)}return void(E.copyrightToggle&&E.copyrightToggle(!0))}var n=E.chosenMedias;if(n[a]){var r;switch("podcast"===n[a][0]&&(r=cur.editingPost&&!cur.editingPost[3].reply&&"wpe_media_preview"===gpeByClass("multi_media_preview",n[a][2]).id),n[a][2]?((v=geByClass1("page_media_x_wrap",n[a][2],"div"))&&v.tt&&v.tt.el&&v.tt.destroy(),domPN(n[a][2])==W&&W.sorter?(each(W.sorter.elems,(function(){setStyle(this,{top:"auto",left:"auto",cursor:"auto"})})),W.sorter.destroy(),re(n[a][2]),W.childNodes.length>1&&sorter.init(W,{onReorder:b.onAddMediaChange})):domPN(n[a][2])==H&&H.qsorter?(each(H.qsorter.elems,(function(){setStyle(domFC(this),{top:"auto",left:"auto"}),setStyle(this,{cursor:"auto"})})),H.qsorter.destroy(),re(n[a][2]),H.childNodes.length>1&&qsorter.init(H,E.qsorterOpts())):re(n[a][2])):"photo"!=n[a][0]&&"video"!=n[a][0]&&"album"!=n[a][0]||window.ThumbsEdit&&ThumbsEdit.removeById("thumbs_edit"+V,n[a][0]+n[a][1]),n[a][0]){case"page":case"share":E.shareData={},re(E.sharePreview),hide("medadd_c_linkimg_loader"),delete E.sharePreview,show(domByClass(q.menuNode,"_type_share")),show(e),(s=ge("signed"))&&disable(s,!isChecked("official")),show(domByClass(q.menuNode,"_type_market"));break;case"pretty_cards":var s;re(E.prettyCardGallery.el),delete E.prettyCardGallery,(s=ge("signed"))&&disable(s,!isChecked("official")),show(domByClass(q.menuNode,"_type_pretty_cards")),show(e);break;case"poll":re(E.pollPreview),delete E.pollPreview,show(domByClass(q.menuNode,"_type_poll"));break;case"map":show(domByClass(q.menuNode,"_type_map"));break;case"podcast":var d=!0;if(r)+cur.editingPost[0].split("_")[0]!==cur.oid&&(d=!1);else{var l=(c=ge("official"))&&gpeByClass("_submit_post_box",c);if(c&&l)domData(l,"from-oid")!==domData(l,"oid")&&(d=!1)}toggle(domByClass(q.menuNode,"_type_podcast"),d);break;case"market":show(e),show(domByClass(q.menuNode,"_type_market")),show(domByClass(q.menuNode,"_type_market_services"));break;case"wall":case"wall_reply":case"story":case"narrative":show(e);break;case"postpone":var c,p=geByClass1("medadd_c_timersett",E.postponePreview);cur.editingPost&&p&&!z?re(domFC(E.postponePreview)):(J.innerHTML="",E.postponeDatepicker=null,E.postponeDate=null),E.postponePreview=!1,(c=ge("official"))&&disable(c,!1);var _=b.poster,u="";if(cur.editingPost)if(cur.editingPost[6]&&intval(cur.editingPost[6].getAttribute("data-suggest"))){u=getLang("wall_publish_suggest");var h=ge("wpe_save");h&&(h.innerHTML=u)}else{u=getLang("wall_publish_now");var g=ge("wpe_save");g&&(g.innerHTML=u)}else u=getLang("wall_send"),ge("send_post").innerHTML=u;_&&_.changeBtnText(u),z?(removeClass(E.menu.postponeBtn,"on"),E.updatePostponeBtnText(!0)):show(domByClass(q.menuNode,"_type_postpone"));break;case"mark_as_ads":show(domByClass(q.menuNode,"_type_mark_as_ads")),E.markAsAds=!1;break;case"copyright":E.copyrightRemove()}n[a]=!1}if(b.toggleLnk){d=E.attachCount()<N;toggle(e,d),b.onToggleBlock&&b.onToggleBlock(d)}toggle(F,!!(U?geByClass1("thumb_wrap",F):domFC(F))),toggle(H,!!domFC(H)),toggle(W,!!domFC(W)),toggle(G,!!domFC(G)),toggle(Y,!!domFC(Y)),toggle(K,!!domFC(K)),toggle(X,!!domFC(X)),z||toggle(J,!!domFC(J)),toggle(Q,!!domFC(Q))}else{var m,v;if(null==a&&(a=0),(v=geByClass("page_media_x_wrap",t,"div")[a])&&v.tt&&v.tt.el&&v.tt.destroy(),1==a){if(z)J.innerHTML="",E.postponeDatepicker=null,E.postponeDate=null,removeClass(E.menu.postponeBtn,"on"),E.updatePostponeBtnText(!0);else if(E.postponePreview){show(geByClass1("add_media_type_"+V+"_postpone",q.menuNode,"a"));var f=domPN(E.postponePreview);window.tooltips&&tooltips.destroyAll(f),re(f),E.postponePreview=!1;var w=q.lastTypes;each(q.types,(function(e,t){"postpone"===t[0]&&w.push(t)})),q.setItems(w)}}else if(2==a&&E.markAsAds){E.markAsAds=!1;var k=geByClass1("page_preview_mark_as_ads_wrap",t);window.tooltips&&k&&tooltips.destroyAll(k),re(k);w=q.lastTypes;each(q.types,(function(e,t){"mark_as_ads"===t[0]&&w.push(t)})),q.setItems(w)}else if(3===a)E.copyrightRemove();else{if(E.postponePreview||E.markAsAds){f=E.postponePreview&&domPN(E.postponePreview),k=E.markAsAds&&domPN(geByClass1("page_preview_mark_as_ads_wrap",t));for(var y=[],C=0;C<t.childNodes.length;C++){var M=t.childNodes[C];"DIV"==M.nodeName&&M!=f&&M!=k&&y.push(M)}each(y,(function(e,t){re(t)}));w=[];each(q.types,(function(e,t){"postpone"===t[0]&&E.postponePreview||"mark_as_ads"===t[0]&&E.markAsAds||w.push(t)})),q.setItems(w)}else val(t,""),addClass(t,"med_no_attach"),q.setItems(q.types);E.chosenMedia&&(E.chosenMedia=!1,E.chosenMediaData=!1),(m=E.shareData)&&(m.url&&E.urlsCancelled.push(m.url),m.initialPattern&&E.urlsCancelled.push(m.initialPattern),E.shareData={}),each([E.sharePreview,E.pollPreview],(function(){re(this)})),E.sharePreview=E.pollPreview=!1}b.toggleLnk&&show(e)}if(toggleClass(t,"media_preview_has_medias",E.hasVisibleRows()&&(hasClass(t,"reply_media_preview")||isVisible(e)||!hasClass("signed","disabled"))),E.copyrightToggle&&E.copyrightToggle(!0),cur.onMediaChanged&&cur.onMediaChanged(n),window.mvcur&&mvcur.onMediaChanged&&mvcur.onMediaChanged(),b.onMediaChanged&&b.onMediaChanged(),E.emitter&&E.emitter.emit(E.eventTypes.mediaUpdate),cur.lastPostMsg=!1,E.onChange&&E.onChange(!1),b.onChangedSize){b.onChangedSize();o=setInterval(b.onChangedSize,50);setTimeout(clearTimeout.bind(null,o),500)}},findChosenMedia:e=>E.chosenMedias.find(t=>t[0]===e),findChosenMediaAllIndices(e){return t=E.chosenMedias,a=t=>t[0]===e,t.reduce((function(e,t,i){return a(t)?e.concat(i):e}),[]);var t,a},chosenMediaToObject(e){var t=v(e,6);return{type:t[0],media:t[1],data:t[5]}},unchooseMediaForType(e){E.findChosenMediaAllIndices(e).forEach(e=>{E.unchooseMedia(e)})},singleAdded:function(a,i){if("copyright"!==i){if("postpone"===i){if(z)return;t.appendChild(a)}else if("mark_as_ads"===i)E.postponePreview?t.insertBefore(a,domLC(t)):t.appendChild(a);else{if(i===k||"situational_theme"===i)return;domFC(t)?t.insertBefore(a,domFC(t)):t.appendChild(a)}removeClass(t,"med_no_attach");var o=[];each(q.lastTypes,(function(e,t){("postpone"!==t[0]||!E.postponePreview&&"postpone"!==i)&&("mark_as_ads"!==t[0]||!E.markAsAds&&"mark_as_ads"!==i)&&(inArray(i,["postpone","mark_as_ads"])||inArray(t[0],["postpone","mark_as_ads"]))&&o.push(t)})),q.setItems(o),b.toggleLnk&&!o.length&&hide(e)}},getMedias:function(e){if(j){var t=window.ThumbsEdit?ThumbsEdit.getMedias("thumbs_edit"+V):[],a={},i=E.chosenMedias||[],o=[],n=function(e,t,i){if(i[0]+i[1]==e)return o.push(i),a[e]=!0,!1};return each(t,(function(e,t){each(i,n.pbind(t[0]+t[1]))})),each(H.childNodes,(function(e,t){var a=(t.id||"").match(/^pam\d+_([a-z]+)(-?\d+_\d+)/);a&&each(i,n.pbind(a[1]+a[2]))})),each(W.childNodes,(function(e,t){var a=(t.id||"").match(/^pam\d+_([a-z]+)(-?\d+_\d+)/);a&&each(i,n.pbind(a[1]+a[2]))})),each(i,(function(e,t){t&&isArray(t)&&t.length&&!a[t[0]+t[1]]&&o.push(t)})),o}return(i=E.chosenMedia)?[e?i:i[0]+i[1]]:[]},showPhoto:function(e){function t(t,a,i,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,a,i){for(var o in!cur.pvData||cur.pvShown&&cur.pvListId==t||delete cur.pvData[t],ajaxCache)o.toString().match(/^\/al_photos\.php\#act=show&draft_photos/)&&delete ajaxCache[o];var n=E.getMedias(),r=[];return each(n,(function(e,t){t&&"photo"==t[0]&&r.push(t[1]+"/"+(E.phLists[t[1]]||""))})),a.additional={},a.additional.open_pe=intval(cur.openEditor),cur.openEditor||(a.additional.draft_photos=r.join(";")),delete cur.openEditor,showPhoto(e,t,extend(a,{queue:1}),i)})),showMediaProgress:function(t,a,i){if(E.onProgress&&!1===E.onProgress(t,a,i))return!1;var o=i.loaded/i.total,n=intval(100*o),r=(i.fileName||i.name||"").replace(/[&<>"']/g,""),s=r?a+"_"+r:a,d=r?r.length>33?r.substr(0,30)+"...":r:"",l=ge("upload"+s+"_progress");if(l){show(l);u=geByClass1("ui_progress_bar",l);setStyle(u,{width:n+"%"})}else{cur.attachMediaIndexes||(cur.attachMediaIndexes={}),cur.attachMediaIndexes[s]=V;var c=`\n          <div class="fl_l">\n            <div class="page_attach_progress_wrap" style="margin-top: 3px; margin-bottom: 4px;">\n              <div id="upload${s}_progress" class="page_attach_progress ui_progress">\n                <div class="ui_progress_back"></div>\n                <div class="ui_progress_bar"></div>\n              </div>\n            </div>\n          </div>\n          ${d?'<div class="attach_label fl_l">'+d+"</div>":""}\n          <div class="progress_x fl_l" onmouseover="animate(this, {opacity: 1}, 200);showTooltip(this, {text: '${getLang("dont_attach")}', shift: [16, 8, 8], black: 1})" onmouseout="animate(this, {opacity: 0.6}, 200);" onclick="Upload.terminateUpload(${a}, '${r||a}', this);"></div>\n          `;if(j){if(Q.appendChild(ce("div",{id:"upload"+s+"_progress_wrap",innerHTML:c,className:"clear_fix upload_"+a+"_progress"},{marginTop:"6px"})),show(Q),b.toggleLnk){var p=E.attachCount()<N;toggle(e,p),b.onToggleBlock&&b.onToggleBlock(p)}}else{var _=ce("div",{id:"upload"+s+"_progress_wrap",innerHTML:c,className:"clear_fix upload_"+a+"_progress"});E.chosenMedia="progress",E.singleAdded(_,"progress")}b.onChangedSize&&b.onChangedSize(),l=ge("upload"+s+"_progress");var u=geByClass1("ui_progress_bar",l);n?setStyle(u,{width:n+"%"}):(setStyle(u,{width:"1px"}),hide(l))}},hasVisibleRows:function(){var e=!1;return each(geByClass("media_preview",t),(function(){if(isVisible(this))return e=!0,!1})),e},attachCount:function(){if(E.attachedCount)return E.attachedCount();if(!t)return 0;if(!j)return t.childNodes.length-(E.postponePreview?1:0)-(E.markAsAds?1:0);var e=(U&&window.ThumbsEdit?(ThumbsEdit.cache()["thumbs_edit"+V]||{}).previews||[]:F.childNodes).length+H.childNodes.length+X.childNodes.length+W.childNodes.length/(W.sorter?2:1)+Q.childNodes.length;return E.sharePreview&&++e,E.pollPreview&&++e,e},onMediaTypesInit(){var e={actionsEl:B,addMedia:E,onMediaChange:b.onMediaChange};E.types.forEach(t=>{var a=t[3],i=a&&a.onMediaTypeInit;i&&i(e)})},pollCreate:function(e){var t=e.poll_html;if(cur.addMedia[V].pollInputData=e,G)if(t){var a=`<div class="medadd_c" id="poll_dummy${V}">${t}</div>`;E.pollPreview=G.appendChild(domFC(cf(a)))}else stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")],()=>{var t=e.poll_question_length,a=e.question,i=e.lang,o=e[y],n=e.answers,r=e[C],s=e[M],l=e[T],c=e[I],p=e[x],_=e[S],u=e.poll_is_board,h=e.poll_is_edit,g=e.poll_is_not_posted,m=e.poll_backgrounds,f=e.poll_answers_limit||10,w=e.poll_no_animate_opening||e.question,k=e[P],A=`\n          <div class="medadd_h medadd_h_poll inl_bl">\n            ${i.question}\n            <span class="medadd_poll_question_warning"></span>\n          </div>\n          <input onkeydown="cur.addMedia[%lnkid%].pollKeydown(this, event)" oninput="cur.addMedia[%lnkid%].pollChangeQuestion(this)" maxlength="${t}" onkeyup="cur.addMedia[%lnkid%].pollKeyup(this, event)" class="text dark medadd_poll_question${u&&h?" disabled":""}"${u&&h?' readonly="readonly"':""} id="create_poll_question%lnkid%" value="%question%" />\n          <div class="medadd_h">${i.answers}</div>\n          <div class="medadd_poll_answers" id="create_poll_answers%lnkid%">\n            %answers%\n          </div>\n          ${u&&h?"":`<div class="medadd_poll_answer_add_wrap" id="create_poll_add%lnkid%">\n            <div class="medadd_poll_answer_add fakeinput dark" onclick="cur.addMedia[%lnkid%].pollAnswerAdd()">${i.answer_add}</div>\n          </div>`}\n          %backgrounds%\n          %settings%\n          <div class="checkbox medadd_datepicker_checkbox medadd_poll_cb%classuntil%" id="create_poll_until%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.until}</div>\n          <div class="medadd_datepicker">\n            <input type="text" class="medadd_datepicker_date dark" id="create_poll_untildate%lnkid%"/><div class="medadd_datepicker_at datepicker_at">${i.at}</div><input type="text" class="medadd_datepicker_time dark" id="create_poll_untiltime%lnkid%"/>\n          </div>\n          ${u?`\n          <div class="checkbox medadd_poll_cb%classonmain%" id="create_poll_onmain%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.add_to_main}</div>\n          `:""}\n          ${u&&h?`\n          <div class="checkbox medadd_poll_cb%classclosed%" id="create_poll_closed%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.close}</div>\n          `:""}\n        `,D=`\n          <div class="medadd_h">${i.settings}</div>\n          ${h&&!g||u?"":`<div class="checkbox medadd_poll_cb%classanon%" id="create_poll_anonymous%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.anonymous}</div>`}\n          ${h?"":`<div class="checkbox medadd_poll_cb%classmulty%" id="create_poll_multy%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.multy}</div>`}\n          ${h?"":`<div class="checkbox medadd_poll_cb%classdisableunvote%" id="create_poll_disable_unvote%lnkid%" onclick="checkbox(this);cur.addMedia[%lnkid%].pollChanged();">${i.disable_unvote}</div>`}\n        `,B=`\n          <div class="medadd_poll_answer_wrap">\n            <input onkeydown="cur.addMedia[%lnkid%].pollKeydown(this, event)" onkeyup="cur.addMedia[%lnkid%].pollKeyup(this, event)" class="text dark medadd_poll_answer${u&&h?" disabled":""}"${u&&h?' readonly="readonly"':""} %attrs%/>\n            <div class="page_media_x_wrap medadd_poll_answer_remove" data-title="${i.answer_remove}" aria-label="${i.answer_remove}" role="button" onmouseover="showTitle(this)" onclick="cur.addMedia[%lnkid%].pollAnswerRemove(this)">\n              <div class="page_media_x"></div>\n            </div>\n          </div>\n        `,$=`\n          <div class="medadd_h">${i.background}</div>\n          <div class="medadd_poll_backgrounds_wrap" id="create_poll_backgrounds_wrap%lnkid%">\n            <div class="medadd_poll_backgrounds_arrow_prev" onclick="cur.addMedia[%lnkid%].pollBackgroundsPaging('prev')"></div>\n            <div class="medadd_poll_backgrounds_arrow_next" onclick="cur.addMedia[%lnkid%].pollBackgroundsPaging('next')"></div>\n            <div class="medadd_poll_backgrounds" id="create_poll_backgrounds%lnkid%">\n              %backgrounds%\n            </div>\n          </div>\n        `;cur.addMedia[V].answersLimit=f,cur.addMedia[V].tplAnswer=B;var L="";u||(L+=cur.addMedia[V].pollBackgroundGetHtml(),m&&m.forEach(e=>{L+=cur.addMedia[V].pollBackgroundGetHtml(e)}),L+=rs('\n          <div class="medadd_poll_background medadd_poll_background_uploader" onclick="cur.addMedia[%lnkid%].pollBackgroundUpload(this);">\n            <div class="medadd_poll_background_preview"></div>\n          </div>\n        ',{lnkid:V}),L=rs($,{lnkid:V,backgrounds:L}));var O="";if(!n||isArray(n)&&!n.length){var N=[];for(var j in e)if(e.hasOwnProperty(j)){var U="answers".length+1;if("answers["===j.substr(0,U)){var R=intval(j.slice(U,-1));N.push([R,e[j]])}}N.length?(n=[],N.sort((e,t)=>e[0]<0&&t[0]<0?e[0]<t[0]:e[0]>=0&&t[0]>=0?e[0]>t[0]:t[0]<0).forEach(e=>{n.push([e[0]<0?e[0]:0,e[1]])})):n=[[0,""],[0,""]]}n.forEach((e,t)=>{var a=v(e,2),i=a[0],o=a[1];O+=rs(B,{attrs:(i?` id="create_poll_ans${i}"`:"")+(o?` value="${clean(Object(d.unclean)(o))}"`:""),lnkid:V})}),E.pollPreview=G.appendChild(ce("div",{className:"medadd_c medadd_poll",innerHTML:rs(A,{lnkid:V,question:a?clean(Object(d.unclean)(a)):"",classuntil:p?" on":"",settings:rs(D,{lnkid:V,classanon:o?" on":"",classmulty:_?" on":"",classdisableunvote:k?" on":""}),backgrounds:L,answers:O,classonmain:r?" on":"",classclosed:s?" on":""})})),n.length==f&&hide("create_poll_add"+V);var z="create_poll_untildate"+V,q=new Datepicker(z,{time:"create_poll_untiltime"+V,width:157,noPast:!0,activePeriod:2592e6,minStep:1,date:p||Math.round(((new Date).getTime()+864e5)/1e3),onUpdate:()=>{var e=new Date,t=new Date(1e3*positive(val(z)));t.getTime()>=e.getTime()+2592e6&&(q.timePicker.hourDD.val(e.getHours()),t.getMinutes()>e.getMinutes()&&q.timePicker.minDD.val(e.getMinutes()),q.setDate(t.getFullYear(),t.getMonth()+1,t.getDate(),!0,e.getHours(),e.getMinutes())),cur.addMedia[V].pollChanged()}});if(cur.addMedia[V].pollBackgroundsPos=0,cur.addMedia[V].pollBackgroundSelect(c?-c:intval(l)),cur.addMedia[V].pollChangeQuestion(ge("create_poll_question"+V)),w)elfocus("create_poll_question"+V),b.onChangedSize&&b.onChangedSize(),cur.addMedia[V].pollUpdateArrows();else{E.pollPreview.style.position="absolute",E.pollPreview.style.visibility="hidden";var F=E.pollPreview.offsetHeight;E.pollPreview.style.height=0,E.pollPreview.style.position="",E.pollPreview.style.visibility="",animate(E.pollPreview,{height:F},b.mail?0:200,()=>{E.pollPreview.style.height="",elfocus("create_poll_question"+V),b.onChangedSize&&b.onChangedSize(),cur.addMedia[V].pollUpdateArrows()})}var H=ge("create_poll_backgrounds_wrap"+V);function W(){addEvent(H,browserFeatures.wheelEvent,cur.addMedia[V].pollMouseWheel)}function Y(){removeEvent(H,browserFeatures.wheelEvent,cur.addMedia[V].pollMouseWheel)}addEvent(H,"mouseenter",W),addEvent(H,"mouseleave",Y),cur.destroy.push((function(){removeEvent(H,browserFeatures.wheelEvent,cur.addMedia[V].pollMouseWheel),removeEvent(H,"mouseenter",W),removeEvent(H,"mouseleave",Y)}))})},pollMouseWheel:function(e){cancelEvent(e);var t=Math.abs(e.deltaY)>Math.abs(e.deltaX)?e.deltaY:e.deltaX;cur.addMedia[V].pollBackgroundsPaging(t,!0)},pollBackgroundsPaging:function(e,t){var a=ge("create_poll_backgrounds_wrap"+V),i=ge("create_poll_backgrounds"+V),o=a.offsetWidth,n=cur.addMedia[V].pollBackgroundsPos;isNumeric(e)?n+=e:"next"===e?n+=o:n-=o,cur.addMedia[V].pollBackgroundsPos=Math.max(0,Math.min(n,i.scrollWidth-o)),t?removeClass(i,"animated"):addClass(i,"animated"),setStyle(i,"transform","translateX("+cur.addMedia[V].pollBackgroundsPos*(vk.rtl?1:-1)+"px)"),cur.addMedia[V].pollUpdateArrows()},pollUpdateArrows:function(){var e=ge("create_poll_backgrounds_wrap"+V),t=ge("create_poll_backgrounds"+V);if(e){var a=e.offsetWidth,i=t.scrollWidth-a;toggleClass(e,"medadd_poll_backgrounds_arrow_prev_disabled",0===cur.addMedia[V].pollBackgroundsPos),toggleClass(e,"medadd_poll_backgrounds_arrow_next_disabled",cur.addMedia[V].pollBackgroundsPos===i||i<=0)}},pollUntilGet:function(){var e=isChecked("create_poll_until"+V)?positive(val("create_poll_untildate"+V)):0;return Math.min(e,(new Date).getTime()+2592e6)},pollBackgroundChange:function(e,t){var a=gpeByClass("medadd_poll_backgrounds",e),i=geByClass1("medadd_poll_background_radio",e);geByClass("medadd_poll_background_radio",a).forEach(e=>{checkbox(e,e===i)}),cur.addMedia[V].pollChanged()},pollAnswerAdd:function(){var e=ge("create_poll_answers"+V),t=geByClass("medadd_poll_answer_wrap",e).length,a=cur.addMedia[V].answersLimit;if(t<a){var i=cf(rs(cur.addMedia[V].tplAnswer,{lnkid:V}));e.appendChild(i);var o=geByClass("medadd_poll_answer",e).pop();elfocus(o)}b.onChangedSize&&b.onChangedSize(),toggle("create_poll_add"+V,t<a-1)},pollAnswerRemove:function(e){e.tt&&e.tt.el&&e.tt.destroy(),re(domPN(e)),b.onChangedSize&&b.onChangedSize(),cur.addMedia[V].pollChanged(),show("create_poll_add"+V)},pollKeydown:function(e,t){if((t=t||window.event)&&(10==t.keyCode||t.keyCode==KEY.ENTER||t.keyCode==KEY.TAB)){var a=hasClass(e,"medadd_poll_question"),i=t.shiftKey;if(a&&i)return;var o=a?domFC(domNS(domNS(e))):(i?domPS:domNS)(domPN(e));return o?elfocus(geByTag1("input",o)):i?elfocus(geByClass1("medadd_poll_question",domPN(domPN(domPN(e))))):this.pollAnswerAdd(),cancelEvent(t)}},pollKeyup:function(e,t){(!(t=t||window.event)||10!=t.keyCode&&t.keyCode!=KEY.ENTER&&t.keyCode!=KEY.TAB)&&(cur.addMedia[V].pollChangedTimeout&&clearTimeout(cur.addMedia[V].pollChangedTimeout),cur.addMedia[V].pollChangedTimeout=setTimeout(()=>cur.addMedia[V].pollChanged(),100))},pollBackgroundGetHtml:function(e){var t="",a=v(e||[0],1)[0];if(a<0){var i=v(e,5),o=i[1],n=i[2],r=i[3],s=i[4];t=`\n          <div class="medadd_poll_background" onclick="cur.addMedia[${V}].pollBackgroundChange(this);">\n            <div class="medadd_poll_background_preview">\n              <div class="medadd_poll_background_preview_lines1"></div>\n              <div class="medadd_poll_background_preview_lines2"></div>\n              <div class="medadd_poll_background_photo" style="background: rgb(${n}, ${r}, ${s});">\n                <div class="medadd_poll_background_photo_holder">\n                  <div class="medadd_poll_background_photo_gradient" style="background: linear-gradient(0, rgba(${n}, ${r}, ${s}, 1) 0, rgba(${n}, ${r}, ${s}, 0) 50%)"></div>\n                  <img src="${o}" class="medadd_poll_background_photo_img"/>\n                </div>\n              </div>\n            </div>\n            <div class="medadd_poll_background_radio radiobtn" data-id="${a}" data-photo-r="${n}" data-photo-g="${r}" data-photo-b="${s}" data-photo-url="${o}"></div>\n          </div>\n        `}else{var d="",l="";if(a){var c=v(e,2)[1];if("gradient"===c){var p=v(e,4),_=p[2],u=p[3],h=[];u.forEach(e=>{var t=v(e,2),a=t[0],i=t[1];h.push(`#${i} ${Math.round(100*a)}%`)}),d=`background: linear-gradient(${_-90}deg, ${h.join(",")});"`}else if("tile"===c){var g=v(e,5),m=g[2],b=g[3];d=`background: url(${g[4]}) top center;background-size: ${m}px ${b}px;"`}}else l=" medadd_poll_background_default";t=`\n          <div class="medadd_poll_background${l}" onclick="cur.addMedia[${V}].pollBackgroundChange(this);">\n            <div class="medadd_poll_background_preview"${d?` style="${d}"`:""}>\n              <div class="medadd_poll_background_preview_lines1"></div>\n              <div class="medadd_poll_background_preview_lines2"></div>\n            </div>\n            <div class="medadd_poll_background_radio radiobtn" data-id="${a}"></div>\n          </div>\n        `}return t},pollBackgroundAdd:function(e){var t=ge("create_poll_backgrounds"+V),a=geByClass1("medadd_poll_background_uploader",t),i=cf(cur.addMedia[V].pollBackgroundGetHtml(e));i=domFC(i),t.insertBefore(i,a)},pollBackgroundSelect:function(e){var t=ge("create_poll_backgrounds"+V);if(t){var a=domQuery1(`.radiobtn[data-id="${e}"]`,t)||domQuery1('.radiobtn[data-id="0"]',t);if(a){var i=domPN(a);cur.addMedia[V].pollBackgroundsPos=(i.offsetLeft-t.offsetWidth/2+i.offsetWidth/2)*(vk.rtl?-1:1),cur.addMedia[V].pollBackgroundsPaging(0,!0),cur.addMedia[V].pollBackgroundChange(i)}}},pollBackgroundGet:function(){var e=domQuery1(`#create_poll_backgrounds${V} .radiobtn.on`);return intval(domData(e,"id"))},pollBackgroundUploaded:function(e,t,a){var i=-intval(e);cur.addMedia[V].pollBackgroundAdd([i,clean(t),intval(a.r),intval(a.g),intval(a.b)]),cur.addMedia[V].pollBackgroundSelect(i)},pollBackgroundUpload:function(){var e=cur.addMedia[V].pollInputData;showBox("al_page.php",{act:"owner_photo_box",oid:e&&e.poll_owner_id||(b.mail?cur.gid?-cur.gid:vk.id:cur.oid||vk.id),lnk_id:V,is_voting:1},{stat:["owner_photo.css",jsc("web/owner_photo.js")]})},pollChanged:function(){b.onMediaChange&&b.onMediaChange()},pollBackgroundsGet:function(){var e=cur.addMedia[V].pollInputData,t=[];e&&e.poll_backgrounds&&e.poll_backgrounds.forEach(e=>{v(e,1)[0]>0&&t.push(e)});var a=ge("create_poll_backgrounds"+V);return geByClass("radiobtn",a).forEach((function(e){var a=intval(domData(e,"id"));a&&a<0&&t.push([a,domData(e,"photo-url"),intval(domData(e,"photo-r")),intval(domData(e,"photo-g")),intval(domData(e,"photo-b"))])})),t},pollData:function(e,t){var a=cur.addMedia[V],o={};if(a&&ge("create_poll_question"+V)){for(var n=ge("create_poll_answers"+V),r=!1,s=0,d=domFC(n);d;d=domNS(d)){var l=trim(val(domFC(d)));if(l){var c=-intval((domFC(d).id.match(/^create_poll_ans(\d+)$/)||[0,-s++])[1]);o[`answers[${c}]`]=l,r=!0}}if(!r)return domFC(n)||a.pollAnswerAdd(),!0!==e&&Object(i.notaBene)(domFC(domFC(n))),!1;var p=trim(val("create_poll_question"+V));if(!p)return!0!==e&&Object(i.notaBene)("create_poll_question"+V),!1;o.question=p,o[x]=a.pollUntilGet();var _=a.pollBackgroundGet();if(_<0?(o[I]=-_,o[T]=0):_>=0&&(o[I]=0,o[T]=_),o[y]=isChecked("create_poll_anonymous"+V)?1:0,o[C]=isChecked("create_poll_onmain"+V)?1:0,o[M]=isChecked("create_poll_closed"+V)?1:0,o[S]=isChecked("create_poll_multy"+V)?1:0,o[P]=isChecked("create_poll_disable_unvote"+V)?1:0,a.pollInputData&&t){o.poll_backgrounds=a.pollBackgroundsGet();var u=["poll_is_board","poll_is_edit","poll_id","poll_answers_limit"];b.mail&&u.push("lang"),u.forEach(e=>{a.pollInputData[e]&&(o[e]=a.pollInputData[e])}),b.mail&&(o.poll_is_edited=0,o["answers[0]"]||o.question!=a.pollInputData.question?o.poll_is_edited=1:[y,C,M,S,x,I,T,P].forEach(e=>{intval(o[e])!==intval(a.pollInputData[e])&&(o.poll_is_edited=1)}),o.poll_is_edited||a.pollInputData.answers.forEach(e=>{var t=v(e,2),a=t[0],i=t[1];void 0!==o[`answers[${-a}]`]&&o[`answers[${-a}]`]==i||(o.poll_is_edited=1)}))}}else a&&ge("poll_dummy"+V)&&a.pollInputData&&a.pollInputData.poll_id&&(o.poll_id=a.pollInputData.poll_id);return o},pollChangeQuestion:function(e){var t=cur.addMedia[V].pollInputData,a=t.poll_question_length-e.value.length,i=geByClass1("medadd_poll_question_warning");i.innerHTML=a<=20?langNumeric(a,t.lang.question_length):""},markAsAdsInit(){var e=this.markAsAdsGetCheckboxEl();e&&attr(e,"onclick",`cur.addMedia[${this.lnkId}].markAsAdsChanged();`)},markAsAdsGetCheckboxEl:()=>!!D&&D.querySelector(".Post__markAsAdsButton"),markAsAdsData(e){var t=!!e&&{},a=this.markAsAds||isChecked(this.markAsAdsGetCheckboxEl());return!a&&this.chosenMedias&&(a=this.chosenMedias.some(e=>{if(isArray(e)&&"mark_as_ads"===v(e,1)[0])return!0})),(a||e)&&(t={mark_as_ads:a?1:0}),t},markAsAdsChanged(){var e=this.markAsAdsGetCheckboxEl();if(e&&!hasClass(e,"disabled")){checkbox(e),Wall&&Wall.togglePostMarkAsAds(e,e.dataset.muteId);var t=this.markAsAdsData(!0).mark_as_ads;E.copyrightToggle&&E.copyrightToggle(!t),E.donutUpdateVisibility(),b.onMediaChange&&b.onMediaChange()}},copyrightInit(){var e=this.copyrightGetBtnEl();e&&attr(e,"onclick",`cur.addMedia[${this.lnkId}].copyrightShowBox();`),this.markAsAdsData(!0).mark_as_ads&&this.copyrightToggle(!1)},copyrightToggle(e){var t=document.querySelector("#post_copyright_btn"+this.lnkId);toggle(t,e);var a=this.copyrightGetBtnEl();a&&(e?(this.copyrightData(!0).copyright?(val(a,getLang("wall_post_copyright_edit_button")),a.classList.add("Post__copyrightButton--added")):(val(a,getLang("wall_post_copyright_add_button")),a.classList.remove("Post__copyrightButton--added")),a.classList.remove("Post__copyrightButton--disabled")):(val(a,getLang("wall_post_copyright_add_button")),a.classList.remove("Post__copyrightButton--added"),a.classList.add("Post__copyrightButton--disabled")))},copyrightGetBtnEl:()=>!!D&&D.querySelector(".Post__copyrightButton"),copyrightCreate(e){if(this.copyrightInputData=e,B&&e&&e.copyright){var t="post_copyright_btn"+this.lnkId,a=document.querySelector("#"+t);if(!a){var i=getLang("wall_post_copyright_source_text");a=cf(`<div class="post_action_btn on" id="${t}" onclick="cur.addMedia[${this.lnkId}].copyrightShowBox();">\n              <div class="post_action_btn_layout">\n                <span class="post_action_btn_text" role="button" aria-label="${replaceEntities(i)}">${i}</span>\n              </div>\n             </div>`),B.appendChild(a)}}this.copyrightChanged()},copyrightRemove(){var e=document.querySelector("#post_copyright_btn"+this.lnkId);e&&e.parentNode.removeChild(e),this.copyrightInputData&&(this.copyrightInputData.copyright=""),this.copyrightChanged()},copyrightUnchoose(){this.chosenMedias&&this.chosenMedias.forEach((e,t)=>{isArray(e)&&"copyright"===e[0]&&this.unchooseMedia(t)}),this.multi||this.copyrightRemove()},copyrightBoxAccept(e){var t=e.btns.ok[0],a=document.querySelector(".PostCopyrightBox__input"),o=document.querySelector(".PostCopyrightBox__error");if(hide(o),!Object(i.isButtonLocked)(t)){var n=val(a);if(!n)return Object(i.notaBene)(a);ajax.post("al_wall.php",{act:"copyright_check_link",link:n},{onDone:()=>{this.copyrightInputData||(this.copyrightInputData={}),this.copyrightInputData.copyright=n,this.chooseMedia("copyright","",this.copyrightInputData),e.hide()},onFail:e=>(val(o,e),show(o),!0),showProgress:()=>Object(i.lockButton)(t),hideProgress:()=>Object(i.unlockButton)(t)})}},copyrightBoxDecline(e,t){t&&this.copyrightUnchoose(),e.hide()},copyrightShowBox(){showBox("al_wall.php",{act:"copyright_box"},{cache:!0,onDone:e=>{cur.postCopyrightFeatureTT&&cur.postCopyrightFeatureTT.hide();var t=this.copyrightData(!0);e.removeButtons(),t.copyright?(e.setOptions({width:400,title:getLang("wall_post_copyright_mb_title_text_edit")}),e.setButtons(getLang("wall_post_copyright_edit_button"),()=>this.copyrightBoxAccept(e),getLang("global_cancel"),()=>this.copyrightBoxDecline(e)),e.setControlsText(`<a onclick="cur.addMedia[${this.lnkId}].copyrightBoxDecline(curBox(), true);">${getLang("global_delete")}</a>`)):(e.setOptions({width:400,title:getLang("wall_post_copyright_mb_title_text")}),e.setButtons(getLang("wall_post_copyright_add_button"),()=>this.copyrightBoxAccept(e),getLang("global_cancel"),()=>this.copyrightBoxDecline(e)),e.setControlsText("")),e.show();var a=document.querySelector(".PostCopyrightBox__input");val(a,t.copyright?Object(d.unclean)(t.copyright):""),addEvent(a,"keypress",t=>Object(s.onEnter)(()=>{this.copyrightBoxAccept(e)},t)),a.focus()}})},copyrightChanged(){var e=this.markAsAdsData(!0).mark_as_ads;this.copyrightToggle(!e),b.onMediaChange&&b.onMediaChange()},copyrightData(e){var t=!!e&&{};return(this.copyrightInputData&&this.copyrightInputData.copyright||e)&&(t={copyright:this.copyrightInputData&&this.copyrightInputData.copyright||""}),t},urlsCancelled:[],shareData:{},checkMessageURLs:function(e,t,a){if(!(cur.noCheckMessageURLs||E.chosenMedia||E.urlAttachmentLoading&&E.urlAttachmentLoading[0]>vkNow()-1e4||E.attachCount()>=N)){if(cur.checkMessageHandler&&Object(u.isFunction)(cur.checkMessageHandler)&&cur.checkMessageHandler(e),cur.reply_to&&cur.reply_to[0]){var i=Wall.getReplyName(cur.reply_to[0]);if(i=i&&isArray(i)&&i[1]?i[1]:""){var o=extractUrls(i,t);for(var n in o)if(o.hasOwnProperty(n)){var r=o[n].url;r.match(/^https?:\/\//)||(r="http://"+r),inArray(r,E.urlsCancelled)||E.urlsCancelled.push(r)}}}var s=extractUrls(e,t).map((function(e){var t=e.url,a=e.query,i=e.domain,o=t,n={};t.match(/^https?:\/\//)||(t="http://"+t);var r=inArray(t,E.urlsCancelled)||inArray(o,E.urlsCancelled),s=!0,d=!1;r||i.match(/(^|\.|\/\/)(vkontakte\.ru|vk\.com)/i)&&(s=!!a.match(/(#photo|^\/(photo|video|album|page|audio|doc|mask|poll|podcast)|z=(album|photo|video|audio_playlist|podcast)|w=(page|product|poll))(-?\d+_)?\d+|app\d+(?:_-\d+)?|\.(jpg|png|gif)$|artist\/([^\/]+).*$|market-?\d+\?section=album_\d+|^\/stickers\/.+$|\?w\=story(\d+)_(\d+)$|stor(y|ies)(\d+)_(\d+)$|^(\/dev)?\/(blog|press|adv)\/.+$|^\/jobs\?w=job\d+$|^\/landings\/.+$|^\/messenger$|^\/fellowship$|^\/talents$|^\/play_safe_at_home$|^\/sale_day$|^\/services$|^\/vk_apps_contest$|^\/home(\/.+)?$|^\/2020(\/.+)?$|^\/notify(\/.+)?$|^\/ahmatova(\/.+)?$|^\/mobile$|^\/miniapps_2019$|^\/data_protection(\?section=(rules|requests|principles))?$|^\/safety(\?section=(social|parents|youth|tips|health|standards))?$|^\/ads(\/([a-zA-Z0-9\_]+))?$|^http:\/\/instagram\.com\/p\/.+/),a.match(A)&&(s=!0),a.match(/narrative(-?\d+_\d+(?:_\d+)?)$/)&&(s=!0),a.match(/^(\/@[._a-zA-Z0-9-]+)([\?|\&]rev=[_a-z0-9]+|[\?|\&]anchor=[-a-zа-я0-9]+)*$/)&&(delete(n=nav.fromStr(t))[0],s=!0),!s&&a.match(/music\/(album|playlist)\/(-?\d+_\d+)(_[a-z0-9]+)?/)&&(s=!0,d=!1),!s&&a.match(/[a-zA-Z0-9_\.-]{2,32}/)&&(s=!0,d=!0));return e.url=t,e.canceled=r,e.valid=s,e.initialUrl=o,e.params=n,e.needsCheckDomain=d,e})).filter((function(e){return!e.canceled&&e.valid})).sort((function(e,t){return e.needsCheckDomain-t.needsCheckDomain}));if(s.length){var d=s[0];d.needsCheckDomain?E.checkURLDomain(d.query,d.initialUrl,a):E.checkURL(d.initialUrl,a,d.params)}}},checkURLDomain:function(e,t,a){cur.checkURLDomainTO&&clearTimeout(cur.checkURLDomainTO),cur.checkURLDomainTO=setTimeout(function(e,t,a){cur.checkURLDomainRequest=ajax.post("share.php",{act:"id_by_link",url:e,to_mail:b.mail},{onDone:function(e,i){(e||i)&&E.checkURL(t,a)},onFail:function(){return!0}})}.pbind(e,t,a),100)},clearCheckURL:function(){clearTimeout(cur.checkURLTO),re(E.urlAttachmentLoading[2]),j?toggle(Q,Q.childNodes>0):toggleClass(t,"med_no_attach",!t.childNodes),E.urlAttachmentLoading=!1,setStyle(bodyNode,{cursor:"default"})},onCheckURLDone:function(e,t,a){var i="";t=t||{},E.urlAttachmentLoading&&(i=E.urlAttachmentLoading[1],E.clearCheckURL()),e?E.chooseMedia(a[0],a[1],extend({},a[2],t),i,!0):((b.onCheckURLDone||function(){})(e,a),(t.onError||function(){})(a))},cancelCheckUrl:function(){re(E.checkURLForm)},_getShareTimeHash:function(){var e=cur.share_timehash||((cur.options||{}).share||{}).timehash||"",t=Math.floor(Date.now()/1e3),a=-1;return e&&(a=parseInt(e.split("_",1)[0])+36e3),a-t<60?Object(r.post)("share.php?act=renew_url_attachment_hash",{act:"renew_url_attachment_hash",hash:e}).then((function(e){var t=e[0];return cur.share_timehash=t,t})):Promise.resolve(e)},checkURL:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e?this._getShareTimeHash().then((function(o){E.urlsCancelled.push(e),E.urlAttachmentLoading=[vkNow(),e],re(E.checkURLForm),E.checkURLForm=ce("div",{innerHTML:'<iframe name="share_parse_iframe'+V+'"></iframe>'}),utilsNode.appendChild(E.checkURLForm);var n=E.checkURLForm.appendChild(ce("form",{action:"/share.php?act=url_attachment",method:"post",target:"share_parse_iframe"+V}));each(extend({hash:o,allowed_share_buttons:((cur.options||{}).share||{}).allowed_buttons||"",index:V,url:e,to_mail:b.mail?1:"",from:b.from,module:cur.module},a),(function(e,t){n.appendChild(ce("input",{type:"hidden",name:e,value:t}))})),setStyle(bodyNode,{cursor:"wait"}),window.onUploadDone=E.onCheckURLDone.pbind(!0,i),window.onUploadFail=E.onCheckURLDone.pbind(!1,i),t&&(cur.checkURLTO=setTimeout((function(){E.urlAttachmentLoading.length>0&&E.clearCheckURL()}),t)),n.submit()})):(i.onError||function(){})()},addPreview:function(e,t){var a=t?" medadd_c_link_hidden":"";return E.sharePreview=Y.appendChild(ce("div",{className:"medadd_c medadd_c_link"+a,innerHTML:'<div class="medadd_c_linkcon"><div></div>'+(e?'<div class="medadd_c_linkprg">'+getProgressHtml("","medadd_c_linkprg_inner")+"</div>":"")+"</div>"}))},shareImgUrl:function(e){var t=E.shareData;if(isArray(t.preview_images)&&t.preview_images[e])return t.preview_images[e];if(t.images_proxy&&t.images_proxy[e])return t.images_proxy_url+t.images_proxy[e];if(t.images){var a=t.images[e];return isArray(a)&&(a=a[0]?a[0]:""),a}return""},initSnippetVideoFunctions:function(){cur.selectSnippetVideo=function(){var e={to_id:b.toId||cur.postTo,act:"a_choose_video_box",snippet_video:1};showBox("al_video.php",e,{cache:1,dark:1})},cur.chooseSnippetVideo=function(e,t){var a=E.shareData,i=e.split("_");a.video_owner_id=i[0],a.video_id=i[1],a.video_full_id=e,a.video=t;for(var o=!1,n=0,r=Object.keys(t.editable.sizes);n<r.length;n++){var s=r[n];(o&&t.editable.sizes[s][1]>t.editable.sizes[o][1]||!o)&&(o=s)}if(o){var d=t.editable.sizes[o];a.images[a.images.length-1]=[d[0],i[0],i[1],"video",t.editable.duration],cur.shareShowNext(0,1)}E.showVideoSnippetPreview()}},showPreview:function(e){var a,i,o,n=E.shareData,r=E.sharePreview||E.addPreview(),s=domFC(r),l=n.is_vk_mini_app,p=window.wkcur&&window.wkcur.shown&&window.wkLayerWrap&&isVisible(window.wkLayerWrap)||(null===(a=window.Videoview)||void 0===a?void 0:a.isLayerShown())||cur.pvLayerCreated,_="ads"===cur.module;n.is_product?addClass(s,"medadd_c_link_product"):removeClass(s,"medadd_c_link_product"),toggleClass(s,"medadd_c_link_special",!(!n.prometheus&&!n.verification)),"comment"!==b.from||l||(n.images=[]),n.prometheus||n.verification||!n.images||(i=n.images[cur.shareShowImg],o=!(!E.bigLink&&!n.big_link||n.force_small_link));var u=!(!cur.options.share||!cur.options.share.allow_snippet_video),h=n.video&&u,g="",m={};if(n.failed)g=getLang("page_not_loaded");else if(n.prometheus)g="im"===cur.module?'<a target="_blank" href="'+n.url+'">'+n.title+"</a>":getTemplate("prometheus_snippet",{author_img:n.prometheus_author_image_url}),e=!0;else if(n.verification)g="im"===cur.module?'<a target="_blank" href="'+n.url+'">'+n.title+"</a>":getTemplate("verification_snippet",{author_img:n.verification_author_image_url}),e=!0;else if(n.template){var f=n.template;f&&(g=getTemplate(f,n))}else{var w="",k=clean(E.shareImgUrl(cur.shareShowImg));if(u&&E.initSnippetVideoFunctions(),!k&&l&&n.images&&n.images[cur.shareShowImg]&&(k=n.images[cur.shareShowImg]),l&&p&&2!==n.images.length)k=v(n.images,2)[1];if(l&&n.edit_video&&(k=n.edit_video.thumb),n.images&&n.images[cur.shareShowImg]&&k){var y=n.images[cur.shareShowImg];if(n.images.length>0){var C,M=!(!cur.options.share||!cur.options.share.allow_custom_photo||n.disable_edit);l&&2===n.images.length&&(M=!1);var T=M&&!(cur.options.share&&cur.options.share.require_image)&&!l,I=!l||_||Object(c.partConfigEnabled)("can_edit_mini_snippet_photo"),x="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_choose_own_photo")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",S="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_choose_own_video")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",P="onmouseover=\"showTooltip(this, {text: '"+getLang("global_link_remove_photo")+"', black: 1, shift: [7, 11, 8], appendParentCls: 'post'})\"",A=isArray(y)&&1==y.length,D=A&&!u,B=A&&u,$=n.media&&"_"!=n.media&&M?'<div class="medadd_c_linkimg_controls">  <div class="medadd_c_linkimg_controls_btn_group clear_fix fl_l">'+(n.images.length>1?'    <div class="medadd_c_linkimg_controls_btn_arrows_group">      <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_left" onclick="cur.shareShowNext(true);"></div>      <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_right" onclick="cur.shareShowNext();"></div>    </div>':"")+(I?'    <div class="medadd_c_linkimg_controls_btn '+(n.images.length>1?"medadd_c_btn_side_padd":"")+'" id="medadd_ctrl_upload" '+x+" onclick=\"Page.ownerPhoto('"+n.media+"');\"></div>":"")+(u?'<div class="medadd_c_linkimg_controls_btn '+(n.images.length>1?"medadd_c_btn_side_padd":"")+'" id="medadd_ctrl_upload_video" '+S+' onclick="cur.selectSnippetVideo();"></div>':"")+"  </div>"+(T?'  <div class="medadd_c_linkimg_controls_btn_group clear_fix fl_r">    <div class="medadd_c_linkimg_controls_btn" id="medadd_ctrl_remove" '+P+' onclick="window.tooltips && window.tooltips.hide(this); cur.removeLinkImage(this)"></div>  </div>':"")+"</div>":"",L=(i?"":"display: none")+";background-image:url("+k+")";n.image_ratio>0&&(L+=";height: 0px; padding-top: "+100*n.image_ratio+"%;min-height: 0px;");var O="video"===y[3]||n.edit_video,N="";l&&O&&(N+=" MiniAppsCoverWrapper--video");var j=y[4]||(null===(C=n.edit_video)||void 0===C?void 0:C.duration);w='<div class="medadd_c_linkimg_container '+(Y&&Y.offsetWidth>550?"medadd_c_linkimg_container_wide":"")+N+'" style="'+L+'">'+w+(O?'<div class="medadd_c_linkimg_container_video_overlay"></div>':"")+(O?'<div class="video_thumb_label"><span class="video_thumb_label_item"></span><span class="video_thumb_label_item">'+j+"</span></div>":"")+(D?'<div class="medadd_c_linkimg_button"><button class="flat_button secondary_dark" onclick="Page.ownerPhoto(\''+n.media+"');\">"+getLang("global_link_choose_own_photo")+"</button></div>":"")+(B?'<div class="medadd_c_linkimg_button"><div class="medadd_c_linkimg_button_half_container"><button class="flat_button secondary_dark" onclick="Page.ownerPhoto(\''+n.media+"');\">"+getLang("global_link_choose_own_photo")+'</button></div><div class="medadd_c_linkimg_button_half_container"><button class="flat_button secondary_dark medadd_c_linkimg_video_button" onclick="cur.selectSnippetVideo();">'+getLang("global_link_choose_own_video")+"</button></div></div>":"")+$+'<div id="medadd_c_linkimg_loader" class="medadd_c_linkimg_loader">'+getProgressHtml("","inv medadd_c_linkimg_loader_inner")+"</div></div>"}}var U="";n.microdata&&n.microdata_preview_html&&(U=n.microdata_preview_html),m={title:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_title")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_title&&!n.disable_edit},description:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_desc")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_desc&&!n.disable_edit},url:{placeholder:'<span class="medadd_inline_placeholder">'+getLang("global_link_edit_url")+"</span>",editable:cur.options.share&&cur.options.share.allow_edit_url&&!n.disable_edit}};var R=n.shareButtons,z=R&&R.length&&R[0],q=n.button_text||z&&z[1],V=n.button_text_lang||z&&z[2],F=n.button_action||z&&z[0];if(R&&R.length&&V===q)for(var H=0;H<R.length;++H)if(R[H][0]===F&&R[H][2]===q){q=R[H][1];break}var W=!1;R&&R.length&&(W=R.length>1||V===q||z[0]!==F||z[1]!==q);var G=!!R&&R.length,K=cur.options.share&&cur.options.share.allow_remove_button&&!h&&!l,X=clean(n.title).replace(/\n/g,"<br>"),J=n.domain,Q="";if(l&&_&&(Q+=" MiniAppsSnippetWrap--ads"),l&&O&&(addClass(s,"MiniAppsSnippetCover--video"),Q+=" MiniAppsSnippetWrap--video"),l&&Object(c.partConfigEnabled)("vk_mini_apps_new_web_snippet")&&stManager.add(["MiniAppsSnippet.css"]),g=w+'<div class="medadd_c_linkwrap '+(w?"":"no_photo")+Q+'"><div class="medadd_c_linkwrap_block">'+(X||m.title.editable?'<div class="medadd_c_linkhead '+(m.title.editable?"medadd_inline_editable":"")+'">'+(m.title.editable?'<div class="medadd_inline_editable_icon"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.6 5.64l2.76 2.76L7.75 15a5.2 5.2 0 01-2.16 1.3l-2.25.69a.26.26 0 01-.33-.33l.7-2.25A5.2 5.2 0 015 12.25l6.6-6.61zm3.95-2.3l1.1 1.1c.44.43.46 1.1.09 1.57l-.08.09-1.18 1.17-2.75-2.75 1.17-1.18c.46-.45 1.2-.45 1.65 0z" fill="currentColor"/></svg></div>':"")+'<span class="medadd_inline_edit_target" data-max-length="'+(cur.options.share&&cur.options.share.max_title_len?cur.options.share.max_title_len:0)+'" data-field="title">'+(clean(n.title).replace(/\n/g,"<br>")||m.title.placeholder)+"</span></div>":"")+(U?'<div class="medadd_c_linkmicrodata">'+U+"</div>":"")+(J||m.url.editable?`<div class="page_media_link_url medadd_c_linkaddr ${m.url.editable?"medadd_inline_editable":""}">${m.url.editable?'<div class="medadd_inline_editable_icon"></div>':""}<span class="medadd_inline_edit_target" data-max-length="2000" data-field="url" data-display-field="domain">${n.domain||"Url..."}</div>`:"")+"</div>"+(V&&G?'<div class="medadd_c_linkwrap_block medadd_c_linkwrap_block_button">'+(K?'<div class="hide_icon medadd_c_linkbtn_remove" onclick="cur.shareRemoveButton();" onmouseover="showTooltip(this, {text: \''+getLang("global_share_button_remove_tooltip")+"', black: 1, shift: [15, 10, 0]})\"></div>":"")+'<div class="wall_postlink_preview_btn medadd_c_linkbtn"><a onclick="cur.toggleShareButton(this);return false;" onmouseout="Page.actionsDropdownHide(domNS(this), 0, cur.setActiveShareButton.pbind(false))" onmouseover="Page.actionsDropdownUnhide()" class="flat_button"><span onmouseover="Page.actionsDropdownUnhide()" class="'+(W?"page_actions_dd_label":"")+' wall_postlink_preview_btn_label" data-field="button_text">'+V+"</span></a></div></div>":"")+'</div><div class="clear_fix"></div>',l&&Object(c.partConfigEnabled)("vk_mini_apps_new_web_snippet")&&!_){g=w;var Z=`<h5 class="MiniAppsSnippetBottomFields__title">${X}</h5>`,ee=`<h6 class="MiniAppsSnippetBottomFields__description">${J}</h6>`,te=`<h6 class="MiniAppsSnippetBottomFields__type_description">${getLang("apps_snippet_mini_app")}</h6>`,ae=`<a class="MiniAppsSnippetBottomButton flat_button">${V}</a>`;g+=o?`\n            <div class="MiniAppsSnippetBottom">\n              <div class="MiniAppsSnippetBottomFields">\n                ${Z}\n                ${ee}\n                ${te}\n              </div>\n              ${ae}\n            </div>\n          `:`\n              <div class="MiniAppsSnippetFields">\n                 ${Z}\n                 ${ee}\n                 ${te}\n                 ${ae}\n              </div>\n            `}}if(o?addClass(s,"medadd_c_linkimg_big"):removeClass(s,"medadd_c_linkimg_big"),e)cur.preventShareAnim&&(cur.preventShareAnim.stop(),clearInterval(cur.animateUpdateInterval),b.onChangedSize&&b.onChangedSize()),val(s,g),s.style.height="auto",shortCurrency();else{show(Y);var ie="";l&&O&&(ie+=" MiniAppsSnippet--video");var oe=t.appendChild(ce("div",{innerHTML:'<div class="medadd_c_linkcon '+(o?"medadd_c_linkimg_big":"")+ie+'">'+g+"</div>"},{position:"absolute",width:getSize(r)[0]-10,visibility:"hidden"})),ne=getSize(oe)[1];re(oe),setStyle(s,{height:"0"}),setStyle(r,{overflow:"hidden"}),val(s,g),shortCurrency(),cur.animateUpdateInterval=setInterval((function(){b.onChangedSize&&b.onChangedSize()}),100),cur.preventShareAnim=animate(s,{height:ne},200,(function(){setStyle(s,{height:"auto",display:""}),setStyle(r,{overflow:""}),clearInterval(cur.animateUpdateInterval),b.onChangedSize&&b.onChangedSize()})),re(geByClass1("medadd_c_linkprg",Y))}function de(e){var t=new RegExp(/^([\w-]*:\/\/)|(tel:).*$/),a=new RegExp(/^(?:tel:)?\+?[0-9()-]+$/),i=new RegExp(/^(([a-zа-я0-9]|[a-zа-я0-9][a-zа-я0-9\-]*[a-zа-я0-9])\.)*([a-zа-я0-9]|[a-zа-я0-9][a-zа-я0-9\-]*[a-zа-я0-9])$/i),o=new RegExp(/^([\w-]*:\/\/)?([a-zа-я0-9\-]+(?:[\-\.]{1}[a-zа-я0-9\-]+)*\.[a-zа-я0-9\-]{2,22})(:[0-9]{1,5})?([\/\?\#].*)?$/i);if(!e||e.inlineEdit)return!1;var n=getSize(e),r=gpeByClass("medadd_inline_editable",e);e.inlineEdit=!0,addClass(r,"medadd_inline_editing"),removeClass(r,"medadd_inline_invalid");var s=ce("textarea",{className:"medadd_inline_edit"},{width:n[0],height:n[1]}),l=parseInt(e.getAttribute("data-max-length"));l&&s.setAttribute("maxlength",l);var c=e.getAttribute("data-field"),p=e.getAttribute("data-display-field");val(s,Object(d.unclean)(E.shareData[c])),val(e,""),e.appendChild(s);var _=ce("span",{className:"medadd_inline_edit_target"},{opacity:0,zIndex:-1,width:n[0],height:"auto",wordWrap:"break-all",position:"absolute"});r.appendChild(_);var u=n[1];if(elfocus(s),"url"===c){var h=E.shareData[c];a.test(h)&&val(s,Object(d.unclean)(h.replace("tel:",""))),s.onkeydown=function(e){32!==e.which&&32!==e.keyCode||e.preventDefault(),13!==e.which&&13!==e.keyCode||(e.preventDefault(),s.blur())},s.oninput=function(){var e=this;cur.editingPostUrlCleanTimeout&&clearTimeout(cur.editingPostUrlCleanTimeout),cur.editingPostUrlCleanTimeout=setTimeout((function(){e.value=e.value.replace(/[\n ]/g,"")}))}}s.onblur=function(){if(s.oninput=null,removeClass(r,"medadd_inline_editing"),re(_),clearTimeout(cur.editingPostUrlCleanTimeout),E.shareData[c]=val(s),"url"===c&&E.shareData[c])try{var n=E.shareData[c];if(a.test(n.replace(/[\h\s(\)-]/g,"")))n=n.replace(/[\h\s\(\)-]|(tel:)/g,""),E.shareData.domain="...",E.shareData[c]="tel:"+n,e.inlineEdit=!1,ajax.post("share.php",{act:"check_phone",url:E.shareData[c]},{onDone:function(t){var a;t&&t.formattedPhone?(E.shareData.domain=clean(t.formattedPhone),a=E.shareData.domain):(addClass(r,"medadd_inline_invalid"),E.shareData.domain=getLang("global_link_invalid_url"),a=E.shareData.domain),val(e,clean(a).replace(/\n/g,"<br>")||m[c].placeholder)},onFail:function(){addClass(r,"medadd_inline_invalid"),E.shareData.domain=getLang("global_link_invalid_url")}});else{t.test(n)||(n="https://"+n);var l=new URL(n);if(!l.host||!i.test(l.host)||!o.test(n))throw new Error("Invalid url");if(a.test(Object(d.unclean)(E.shareData.domain).replace(/[\h\s\(\)-]/g,""))||i.test(E.shareData.domain)||E.shareData.domain===getLang("global_link_invalid_url")||E.shareData.domain===getLang("global_link_edit_url")){var u=n.match(o);E.shareData[c]=n.replace(o,"$1"+u[2].toLowerCase()+"$3$4"),E.shareData.domain=u[2].toLowerCase()}}}catch(e){addClass(r,"medadd_inline_invalid"),E.shareData.domain=getLang("global_link_invalid_url")}var h;"url"!==c||E.shareData[c]||(E.shareData.domain=getLang("global_link_edit_url")),h=p&&E.shareData[p]?E.shareData[p]:val(s),val(e,clean(h).replace(/\n/g,"<br>")||m[c].placeholder),e.inlineEdit=!1};var g=function(){var e=clean(val(s)+" M").replace(/\n/g,"<br>");val(_,e);var t=getSize(_);u!=t[1]&&(u=t[1],animate(s,{height:t[1]},200))};addEvent(s,"click keyup change",g),setTimeout(g,0)}if(m.title&&m.title.editable){var le=geByClass1("medadd_c_linkhead",s),pe=geByClass1("medadd_inline_edit_target",le);le&&pe&&(le.onclick=de.bind(this,pe))}if(m.description&&m.description.editable){var _e=geByClass1("medadd_inline_edit_target",geByClass1("medadd_c_linkdsc",s));_e&&(_e.onclick=de.bind(this,_e))}if(m.url&&m.url.editable){var ue=geByClass1("medadd_c_linkaddr",s),he=geByClass1("medadd_inline_edit_target",ue);ue&&he&&(ue.onclick=de.bind(this,he)),b.linkTooltip&&!cur.linkTooltip&&ue&&(cur.linkTooltip=new ElementTooltip(b.linkTooltip.el(ue),b.linkTooltip.opts),b.linkTooltip.timeout?setTimeout(()=>cur.linkTooltip.show(),b.linkTooltip.timeout):cur.linkTooltip.show())}if(G&&(E.shareData.button_text=q,E.shareData.button_text_lang=V,E.shareData.button_action=F,W)){var ge=domPN(geByClass1("wall_postlink_preview_btn_label",s)),me=[],ve=0,be=0,fe=[];for(var H in R)if(R.hasOwnProperty(H)){var we=R[H];we[0]==F&&we[1]==q&&(ve=be),me.push([be++,we[1]]),fe.push('<a class="page_actions_item" tabindex="0" role="link" onclick="cur.updateShareButton(this);Page.actionsDropdownHide(domPN(domPN(this)), 1, cur.setActiveShareButton.pbind(false));return false;" data-button-text="'+we[1]+'" data-button-text-lang="'+we[2]+'" data-button-action="'+we[0]+'">'+we[2]+"</a>")}ge.setAttribute("data-items",JSON.stringify(me)),ge.setAttribute("data-value",ve);var ke=['<div class="page_actions_wrap medadd_c_linkbtn_actions_wrap unshown" onmouseout="Page.actionsDropdownHide(this, 0, cur.setActiveShareButton.pbind(false))" onmouseover="Page.actionsDropdownUnhide()" onmouseup="setTimeout(function() { Page.actionsDropdownUnhide(); }, 5)">','<div class="page_actions_inner">',fe.join(""),"</div>","</div>"].join("");domPN(ge).appendChild(se(ke)),ls.get("share_button_text_tooltip_shown")||cur.buttonTextTooltip||setTimeout((function(){cur.closeButtonTextTooltip=function(){cur.buttonTextTooltip.hide(),ls.set("share_button_text_tooltip_shown",1)};var e=geByClass1("wall_postlink_preview_btn_label",s),t=domCA(e,".box_layout");cur.buttonTextTooltip=new ElementTooltip(e,{autoShow:!1,appendTo:t||geByTag1("body"),content:'<div class="feature_intro_tt_hide" onclick="cur.closeButtonTextTooltip();"></div>'+getLang("global_share_button_text_tooltip"),forceSide:"left",cls:"feature_intro_tt feature_intro_blue_tt",offset:[-10,0,0],onHide:function(){cur.buttonTextTooltip.destroy()}}),cur.buttonTextTooltip.show(),addEvent(e,"mouseover",(function(){cur.buttonTextTooltip&&cur.buttonTextTooltip.hide()}))}),1e3)}},showVideoSnippetPreview:function(){if(!(!cur.options.share||!cur.options.share.allow_snippet_video)){var e=E.shareData,t=e.video,a=e.video_owner_id,i=e.video_id;t&&isObject(t)&&a&&i&&t.editable&&(E.initSnippetButtonFunctions(),E.showPreview())}},initSnippetButtonFunctions:function(){cur.shareRemoveButton=function(){var t=E.sharePreview;window.tooltips&&tooltips.destroyAll(t),re(geByClass1("medadd_c_linkwrap_block_button",t)),E.shareData.button_text="",E.shareData.button_text_lang="",E.shareData.button_action="",show(domByClass(e,"media_selector"))},cur.updateShareButton=function(e){var t=e.getAttribute("data-button-text"),a=e.getAttribute("data-button-text-lang"),i=e.getAttribute("data-button-action");E.shareData.button_text=t,E.shareData.button_text_lang=a,E.shareData.button_action=i;var o=E.sharePreview;return val(geByClass1("page_actions_header_inner",o),a),val(geByClass1("wall_postlink_preview_btn_label",o),a),!1},cur.setActiveShareButton=function(e){var t=E.sharePreview;(e?addClass:removeClass)(domPN(geByClass1("wall_postlink_preview_btn_label",t)),"active")},cur.toggleShareButton=function(e){hasClass(e,"active")?(Page.actionsDropdownHide(domNS(e),1),cur.setActiveShareButton(!1)):(Page.actionsDropdown(domNS(e)),cur.setActiveShareButton(!0))}},showExternalPreview:function(){var e=E.shareData;e.images||(e.images=[]);var t,a=[],i=[],o={};each(e.images,(function(t,n){o[n]||(o[n]=!0,a.push(n),e.images_proxy&&i.push(e.images_proxy[t]))})),e.uniqueImagesCount=a.length,e.images=a,e.images_proxy=i;var n=!(!cur.options.share||!cur.options.share.allow_snippet_video);if(t=Y&&Y.offsetWidth>550?isRetina()?"/images/post_snippet_image_placeholder_w_2x.png":"/images/post_snippet_image_placeholder_w.png":n?isRetina()?"/images/post_snippet_image_video_placeholder_2x.png":"/images/post_snippet_image_video_placeholder.png":isRetina()?"/images/post_snippet_image_placeholder_2x.png":"/images/post_snippet_image_placeholder.png",e.placeholder_inserted||(e.images.push([(cur.options.share||{}).allow_custom_photo?t:""]),e.placeholder_inserted=!0),!e.images||!e.images.length)return cur.shareShowImg=0,void E.showPreview();cur.shareShowImg=0,cur.shareShowImg--,E.addPreview(!0,!!e.map_data),e.imagesStyles={};var r=!1;cur.shareSetOwnPhoto=function(t){curBox()&&curBox().hide(),E.bigLink=!0,e.isPhotoEdit=!0,e.images[e.images.length-1]=[t.photo_url,t.user_id,t.photo_id],cur.shareShowNext(0,1)},cur.shareClearOwnPhoto=function(){e.images[e.images.length-1]=[],cur.shareShowNext(0,0,1)},cur.removeLinkImage=function(t){var a=gpeByClass("medadd_c_linkcon",t);addClass(a,"no_photo"),removeClass(a,"medadd_c_linkimg_big"),re(gpeByClass("medadd_c_linkimg_container",t)),setStyle(a,"height",""),e.video_edit&&e.is_vk_mini_app&&removeClass(a,"MiniAppsCoverWrapper--video"),E.shareData.noPhoto=!0},E.initSnippetButtonFunctions(),cur.shareShowNext=function(a,i,o){var n=vkImage(),s="ads"===cur.module;cur.prevShareShowDir=a,o||(i?cur.shareShowImg=e.images.length-1:a?cur.shareShowImg-=1:cur.shareShowImg+=1);var d=cur.shareShowImg;!e.is_vk_mini_app||-1!==d&&2!==d||s||(cur.shareShowImg=a?1:0);var l=isArray(e.images[e.images.length-1])&&!!e.images[e.images.length-1][0];if(!l&&cur.shareShowImg>e.images.length-2)cur.shareShowImg=0;else if(cur.shareShowImg>e.images.length-1)cur.shareShowImg=0;else if(!l&&cur.shareShowImg<0)cur.shareShowImg=e.images.length-2;else if(cur.shareShowImg<0)cur.shareShowImg=e.images.length-1;else if(0==cur.shareShowImg)for(var c=1;c<e.images.length-1;c++){vkImage().src=E.shareImgUrl(c)}if(!e.images.length||isEmpty(e.images)||void 0===e.images[cur.shareShowImg])return E.showPreview(r),void(r=!0);var p=E.shareImgUrl(cur.shareShowImg);p&&(n.src=p),e.video=0,isArray(e.images[cur.shareShowImg])&&e.images[cur.shareShowImg][1]&&e.images[cur.shareShowImg][2]?"video"===e.images[cur.shareShowImg][3]?(e.video=1,e.video_owner_id=e.images[cur.shareShowImg][1],e.video_id=e.images[cur.shareShowImg][2]):(e.user_id=e.images[cur.shareShowImg][1],e.photo_id=e.images[cur.shareShowImg][2],e.share_own_image=!0):(e.user_id=void 0,e.photo_id=void 0,e.share_own_image=!1);var _=null;p&&(cur.imgLoadTimeout=_=setTimeout((function(){!0!==cur.shareImgInterval&&(isArray(e.images[cur.shareShowImg])||(e.images.splice(cur.shareShowImg,1),e.images_proxy&&e.images_proxy.length>cur.shareShowImg&&e.images_proxy.splice(cur.shareShowImg,1),cur.shareShowNext()))}),5e3));var u=setTimeout((function(){show("medadd_c_linkimg_loader"),u=null,b.onChangedSize&&b.onChangedSize()}),100);cur.showLoaderTimeout=u;var h=function(){if(n.width||n.height||!p){var a=n.width,i=n.height,o="",s="";if(_&&(clearTimeout(_),_=null),u&&(clearTimeout(u),u=null),hide("medadd_c_linkimg_loader"),clearInterval(cur.shareImgInterval),!isArray(e.images[cur.shareShowImg])&&(a<150||i<67)){if(e.images.splice(cur.shareShowImg,1),e.images_proxy&&e.images_proxy.length>cur.shareShowImg&&e.images_proxy.splice(cur.shareShowImg,1),e.images.length)return setTimeout(cur.shareShowNext.pbind(0,0,1),0)}else{var d=a>=532&&i>=235,l=(d||!!e.big_link)&&!e.force_small_link;if(cur.options.share&&cur.options.share.force_big_link&&!d){e.images.splice(cur.shareShowImg,1),e.images_proxy.splice(cur.shareShowImg,1);var c=(cur.options.share||{}).allow_custom_photo||(cur.options.share||{}).require_image;return 0==e.images.length&&c&&e.images.push([c?t:""]),cur.prevShareShowDir||cur.shareShowImg--,void cur.shareShowNext(cur.prevShareShowDir)}E.bigLink=l,l?o="width: 100%;":(a>150&&(i=150*i/a,a=150),o="width: "+a+"px; height: "+i+"px;")}e.images.length>1&&(s=""),e.imagesStyles[cur.shareShowImg]='style="'+o+'"'+s,E.showPreview(r),r=!0,b.onAddMediaChange&&b.onAddMediaChange("share",e.media,e)}};clearInterval(cur.shareImgInterval),cur.shareImgInterval=setInterval(h,300),cur.shareImgInterval2=setTimeout(h,0)},cur.shareShowNext()},uploadShare:function(e){var t=E.shareData,a=E.sharePreview,i=a.appendChild(ce("div",{innerHTML:'<iframe class="upload_frame" name="share_upload_iframe'+V+'"></iframe>'})),o=i.appendChild(ce("form",{action:"/share.php",method:"post",target:"share_upload_iframe"+V})),n=t.images[cur.shareShowImg];each({act:"a_photo",url:t.url,index:V,image:n,extra:t.extra||0,hash:vk.ip_h},(function(e,t){o.appendChild(ce("input",{type:"hidden",name:e,value:t}))})),window.onUploadDone=function(t,o){window.onUploadFail=window.onUploadDone=function(){},a.removeChild(i),E.shareData=extend(E.shareData,{user_id:o.user_id,photo_id:o.photo_id,photo_url:n}),setTimeout(e,0)},window.onUploadFail=function(t,o){window.onUploadFail=window.onUploadDone=function(){},a.removeChild(i),E.shareData.share_upload_failed=1,setTimeout(e,0)},cur.shareLastParseSubmitted=vkNow(),o.submit()},setupPostpone:function(e,a,i){var o;o=j||J?J:domPN(geByClass1("page_preview_postpone_wrap",t));var n=cur.editingPost&&"wpe_media_preview"==domPN(o).id,r=n||!j?"":"1px",s=!1,d=`<div class="clear_fix">\n        <div class="fl_l datepicker_item"><input type="hidden" id="postpone_date${V}" value="${e.date||""}" /></div>\n        <div class="fl_l datepicker_item medadd_c_timerat">${e.lang.profile_wall_postpone_at}</div>\n        <div class="fl_l datepicker_item"><input type="hidden" id="postpone_time${V}"/></div></div>`,l=void 0!==e.friends_only;cur.editingPost&&l?(d+='<div class="medadd_c_timersett">',E.visibilityAddSelect(e),s=!0):cur.editingPost&&a&&(d+=a,s=!0),z||(E.postponePreview=o.appendChild(ce("div",{className:"medadd_c medadd_c_timer clear_fix"+(s?" medadd_c_nofixed":"")+(z?" timer_in_tt":""),innerHTML:d}))),z&&(E.postponeSubmitWrapper=se(`<div><input type="hidden" id="postpone_date${V}" value="${e.date||""}"><input type="hidden" id="postpone_time${V}"></div>`),o.appendChild(E.postponeSubmitWrapper)),z||(E.postponePreview.style.height=r);var c="datepicker-inline-container_"+V,p=`<button class='flat_button reset_time_btn secondary' onclick='cur.addMedia[${V}].onResetPostponeBtnClick()'>${getLang("wall_post_timer_reset")}</button>`,_=`<td class="cal_clear" id="${c}" colspan="7">${p}</td>`;stManager.add(["ui_controls.css","ui_controls.js","datepicker.css",window.jsc("web/datepicker.js")],(function(){E.postponeDatepicker=new Datepicker("postpone_date"+V,{time:"postpone_time"+V,width:155,noPast:!0,minStep:1,sideTop:cur.oid<0,sideTopOffset:10,inlineTime:z,inlineTimeContainerId:c,inlineTimeContainerIdx:V,addRows:z?"<tr>"+_+"</tr>":null,addRowsM:z?'<tr><td class="cal_clear" colspan="7"></td></tr>':null,onUpdate:function(e,t){var a=[...arguments];b.onMediaChange&&b.onMediaChange.apply(b,a),E.postponeDate=val("postpone_date"+E.lnkId),z&&E.updatePostponeBtnText()},hideAnotherMonth:!1}),n||!j||z||animate(E.postponePreview,{height:33},200,(function(){E.postponePreview.style.height=""})),E.menu.postponeBtn&&E.updatePostponeBtnText(),Object(u.isFunction)(i)&&i()}))},getPostponeDateString:function(e){if(val("postpone_date"+E.lnkId)||e){e=(e=e||+val("postpone_date"+E.lnkId))+(60*(new Date).getTimezoneOffset()+intval(vk.tz))+intval(vk.dt);var t=getLang("datepicker_dateFormat");"dateFormat"===t&&(t="{day} {month} {year}");var a=new Date(1e3*e),i=a.getDate(),o=a.getMonth()+1,n=a.getFullYear();return t.replace("{day}",i).replace("{month}",winToUtf(getLang("Month"+o+"_of"))).replace("{year}",n)+` ${getLang("profile_wall_postpone_at")} `+`${a.getHours()}:${("0"+a.getMinutes()).slice(-2)}`}},onResetPostponeBtnClick(){cur["postPostponeTT"+E.lnkId].hide(),null!=E.postponeInd&&setTimeout(()=>{E.unchooseMedia(E.postponeInd)},ElementTooltip.FADE_SPEED),cancelEvent(window.event)},resetPostpone:function(e){if(e){e=e+(60*(new Date).getTimezoneOffset()+intval(vk.tz))+intval(vk.dt);var t=new Date(1e3*e);if(t){var a=t.getDate(),i=t.getMonth()+1,o=t.getFullYear(),n=t.getHours(),r=t.getMinutes();E.postponeDatepicker.timePicker.hourDD.val(n),E.postponeDatepicker.timePicker.minDD.val(r),E.postponeDatepicker.setDate(o,i,a,null,n,r)}}},updatePostponeBtnText:function(e,t){if(z){var a=geByClass1("post_action_btn_text",E.menu.postponeBtn),i="";if(e)i=getLang("wall_publication_now");else{var o=E.getPostponeDateString(t);if(!o)return;i=o}a.innerHTML=i,a.setAttribute("aria-label",replaceEntities(i))}},createPrettyCards:function(e){cur.lang=extend(cur.lang||{},e.lang||{});var t=se(e.editor.container_html);Y.appendChild(t),E.prettyCardGallery=new PrettyCardGallery(t,e.editor,e.pretty_cards)},visibilityAddSelect:function(e){var t,a=!1,i=!1;e.friends_only?(a=!0,t="name_friends_only"):e.best_friends_only?(i=!0,t="name_best_friends_only"):t="name_no_friends_only";var o=se(getTemplate("visibility_access",{link_id:V}));toggleClass(o,"on",a),toggleClass(o,"best_friends_only",i);var n=geByClass1(t,o),r="post_visibility_btn",s=+domData(n,"value"),d=geByClass1("post_action_btn_text",o),l=i?getLang("wall_best_friends_only"):val(n);if(val(d,l),attr(d,"aria-label",l),o){var c=geByClass1("post_action_btn",B);c?B.insertBefore(o,c):B.appendChild(o),Wall.createPostTooltip(r,V)}radiobtn(n,s,"post_settings_btn"+r+V)},donutVisibilityAddSelect(e){var t=Object(p.donutVisibilityInit)(e);t&&t.donutPostSettings&&(E.donutPostSettings=t.donutPostSettings)},donutUpdateVisibility(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;E.donutPostSettings&&E.donutPostSettings.donutUpdateVisibility(e)},destroy:function(){(W||{}).sorter&&W.sorter.destroy();for(var a=0;a<q.handlersToClean.length;a++)q.handlersToClean[a]();(H||{}).qsorter&&H.qsorter.destroy(),removeClass(t,"media_preview_has_medias"),t&&(t.innerHTML=""),show(e)},qsorterOpts:function(){return{xsize:Math.floor(H.offsetWidth/135),width:135,height:102,onReorder:b.onAddMediaChange,clsUp:"pam_dpic_up"}},resized:function(){window.ThumbsEdit&&ThumbsEdit.setWide("thumbs_edit"+cur.wallEditComposer.addMedia.lnkId),H.qsorter&&(H.qsorter.destroy(),window.qsorter.init(H,E.qsorterOpts()))}}).copyrightInit(),E.markAsAdsInit(),E.onMediaTypesInit(),cur.addMedia||(cur.addMedia={}),cur.addMedia[V]=E,b.onAddMediaChange&&(E.onChange=b.onAddMediaChange),q.activate(),E}}},vkK6:function(e,t,a){"use strict";a.r(t),a.d(t,"getActionData",(function(){return o}));var i=a("ZD4m"),o=function(e){var t=Object(i.getJsonDataValue)(e,"data-action-params");if("object"==typeof t||null===t)return{actionParams:t}}}}]);try{stManager.done("cmodules/bundles/88ece9fd553062188532d75b5446f241.cad2d1c2d5fa218e6d4f.js")}catch(e){}