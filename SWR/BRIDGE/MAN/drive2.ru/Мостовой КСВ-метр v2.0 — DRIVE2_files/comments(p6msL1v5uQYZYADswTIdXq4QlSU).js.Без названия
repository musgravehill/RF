if(typeof __d2=="object"){(function(_){var Yw=function(a){_.cb.call(this);this.g=a;this.j=[];this.ja=new _.Lg(this)},ax=function(a){if(!a.__ready){var b=_.R(a,"xtag");b&&Zw.hasOwnProperty(b)&&Zw[b].add&&(a.__ready=!0,Zw[b].add(a,b));$w&&(b=_.R(a,"xslot"))&&(a.__ready=!0,$w(a,b))}},cx=function(a,b){a.__component||(a.__component=new bx[b](a))},dx=function(a){var b=a&&a.__component;b&&(_.D(b),delete a.__component)},ex=function(a,b){if(bx.hasOwnProperty(a))throw Error('Duplicate key "'+a+'" in the components registry.');bx[a]=b;if(Zw.hasOwnProperty(a))throw Error('Duplicate observer key "'+
a+'".');Zw[a]={add:cx,remove:dx}},fx=function(a){return _.cf('[data-xtag="'+a+'"]',void 0).filter(function(a){return!!a.__component}).map(function(a){return a.__component})},gx=function(a,b){return(a=(b||window.document).querySelector('[data-xtag="'+a+'"]'))&&a.__component},hx=function(a){return(a=a.parentNode?a.parentNode.closest("[data-xtag]"):null)&&a.__component},ix=function(a){Yw.call(this,a);this.i=(_.R(a,"menu")||"").split(",");this.s=null;this.ja.C(a,"click",this.v)},jx=function(a){a.i=a.i.map(function(a){return"blacklist"===
a?"unblacklist":"unblacklist"===a?"blacklist":a})},lx=function(a){return a.i.map(function(a){return Object.assign({},kx[a],{action:a})})},mx=function(a){Yw.call(this,a);var b=this;this.files=[];this.i=null;this.s=!1;if(a=_.R(this.g,"thumb"))this.s=!0,this.files.push({thumbnail:[a]});this.ja.ha(this.g,"click",function(){b.s=!0;b.update();_.W.g("upload-button.click",b.g);_.W.g("th")});this.update()},nx=function(a){return 0<a.files.length?a.files[0]:null},ox=function(a){Yw.call(this,a);var b=this;this.s=
null;this.A=""===_.R(a,"inline");this.v=0;this.i=null;_.On(a,this.T.bind(this));_.dc(_.W,"upload-button.click",function(a){hx(a)===b&&(0,window.clearTimeout)(b.v)})},px=function(a,b,c,d){if((0,_.mh)()){var e=_.Re(b),f=_.Re(c),g=_.Ie(b),k=_.Ie(c),l={opacity:.2},m={opacity:1};l[_.Lm]="translateZ(0) translate("+(k.x-g.x)+"px,"+(k.y-g.y)+"px) scale("+f.width/e.width+")";m[_.Lm]="";a.i=new _.xg(b,.5,l,m,"all 0.5s ease-in-out");a.i.ha("end",function(){_.D(a.i);a.i=null;_.B(b,"is-animated");d&&_.vn(_.Bn(c))});
_.A(b,"is-animated");a.i.play()}b.style.visibility="visible"},rx=function(a,b){(0,_.Y)("comments.comment",a).T("/ajax/admin.cshtml",b).then(function(a){return a.json}).then(function(c){var d=qx.Lk+" "+c.nickname,e=c.unmuteTime,f=c.comment,g=c.denySelect;c=c.history;e='<div class="c-dialog-modcomment">\n'+(_.V?"":'<h3 class="c-header">'+d+"</h3>")+'\n<form class="c-dialog-form" novalidate>\n'+(e?'<div class="c-dialog-desc c-dialog-desc--warning">'+qx.Gk+" "+e+"</div>":"")+'\n<div class="c-dialog-form__field">\n<label class="c-dialog-form__legend">'+
qx.Ik+'</label>\n<div class="c-dialog-modcomment__comments js-modcomments">\n<span><span class="c-link">'+qx.Jk.replace(/\|/g,'</span></span> <span><span class="c-link">')+'</span></span>\n</div>\n<textarea class="c-textarea js-modcomment" name="mcomment" data-autofocus="1">'+_.rb(f||"")+'</textarea>\n</div>\n<div class="c-dialog-form__field">\n<label class="c-dialog-form__legend-h" for="{id}.b">'+qx.Hk+'</label>\n<select class="c-input" name="unmutedate" id="{id}.b">'+g+'</select>\n</div>\n<div class="o-group o-group--m o-group--end o-group--wide c-dialog-buttons">\n<span class="c-dialog-buttons__spinner is-skip js-spinner"></span>\n<button class="c-button c-button--m-no-padding" name="submitbtn" type="submit" value="'+
(e?1:0)+'">\n'+(e?qx.Kk:qx.Fk)+"\n</button></div></form></div>\n"+(c?'<div class="c-dialog-modcomment__table">'+c+"</div>":"");var k=new _.Qn(a,e,d);d=_.Rn(k);k.C("submit",function(a){a=a.target;var c=Object.assign({},b,{_:"1"===a.submitbtn.value?"remindCommentingRules":"muteUserComments",text:a.mcomment.value,days:a.unmutedate.value});(0,_.Y)("comments.comment",a.submitbtn).T("/ajax/admin.cshtml",c).then(function(){k.close()}).catch(function(){_.Sn(k)})});var l=_.O("js-modcomment",d.Y);_.P(_.O("js-modcomments",
d.Y),"click",function(a){"SPAN"===a.target.nodeName&&(l.value=(l.value?l.value+", ":"")+_.ub(a.target.innerHTML))})}).catch(function(){})},ux=function(a){return _.ub((0,_.xb)(a.replace(sx,function(a,c){return tx.test(c)?"":" "}).replace(/[\t\n ]+/g," ")))},yx=function(a){Yw.call(this,a);var b=this;this.ub=_.yh(this.g);this.i=""===this.ub.thread;this.v=this.s=null;_.dc(_.W,"x-comment-dropdown.select",function(a,d,e){if(hx(a)===b)switch(e){case "edit-history":case "edit-history-hide":vx(b,d);break;
case "edit":b.sn(d);break;case "blacklist":b.lh(d,!0);break;case "unblacklist":b.lh(d,!1);break;case "spam":b.rq(d);break;case "thread-moderate":wx(b,d,!0);break;case "thread-hide":case "delete":wx(b,d);break;case "mod":a=xx(b,"getUserCommentsModerationData"),rx(d,a)}})},zx=function(a,b){if(a.s)return a.s;var c=fx("x-comment-form").find(function(a){return _.z(a.g,"is-original")}).g.cloneNode(!0);a.s=c;_.B(c,"is-original");c.id="";_.xh(c,"hidden");var d=c.text;d.style.height="";d.setAttribute("placeholder",
qx.Pl);d.value="";b=_.Cd("input",{type:"hidden",name:"parent",value:b||""});c.appendChild(b);_.M(c,!1);_.Md(c,a.g);return c},xx=function(a,b,c){c=void 0===c?{}:c;a=a.ub;return Object.assign("getUserCommentsModerationData"===b?{userId:a.user,forumId:a.forum,messageId:a.id}:{owner:a.owner,ownerId:a.ownerid,id:a.id},{_:b},c)},vx=function(a,b){var c=xx(a,a.i?"ht":"hc"),d=_.O("js-history",a.g);!0===d.__loaded?_.un(_.Bn(d)):(0,_.Y)("comments.comment",b).T("/ajax/forums.cshtml",c).then(function(a){return a.json}).then(function(b){b.html&&
(d.__loaded=!0,_.ln("Comment","History Toggle"),_.M(d,!1),d.innerHTML=b.html,_.Bn(d).C("start",function(b){var c=gx("x-comment-dropdown",a.g);c&&(b.target.hb?(b=c.i.indexOf("edit-history"),-1!==b&&(c.i[b]="edit-history-hide")):(b=c.i.indexOf("edit-history-hide"),-1!==b&&(c.i[b]="edit-history")))}),_.un(_.Bn(d)))}).catch(function(){})},wx=function(a,b,c){c=xx(a,a.i?c?"mt":"dt":"dc");(0,_.Y)("comments.comment",b).T("/ajax/forums.cshtml",c).then(function(a){return a.json}).then(function(b){a.i?b.url?
window.location.href=b.url:window.location.reload():_.vn(_.Bn(a.g))}).catch(function(){})},Ax=function(a){var b=_.Vi(a),c=a.node(),d=c.closest(".js-thread");a=_.yh(d);var e={_:b,owner:a.owner,ownerId:a.ownerid,id:a.id};_.th(c,"mt"===b?qx.He:qx.Yg,_.or.Za,_.or.Fa).then(function(){(0,_.Y)("comments.ext",c).T("/ajax/forums.cshtml",e).then(function(){var a=d.closest(".js-entity");a=a&&1===_.df("js-thread",a).length?a:d;_.K(a)}).catch(function(){})}).catch(function(){})},Bx=function(a){a=a.node();var b=
_.R(a,"url");if(b){var c=_.Cd("div","c-media",b=_.Cd("iframe",{src:b+"&autoplay=1",frameborder:0}));b.setAttribute("allowfullscreen","");_.Md(c,a);_.K(a)}};_.oa(Yw,_.cb);Yw.prototype.fd=function(){};Yw.prototype.H=function(){this.ja.O();this.ja=null;this.j.length=0;_.cb.prototype.H.call(this)};var Zw={},$w;_.sl(function(){_.cf("[data-xtag],[data-xslot]").forEach(ax)},!0);$w=function(a,b){var c=hx(a);c&&!c.j.hasOwnProperty(b)&&(c.j[b]=a,c.fd(b,a))};var bx={};var qx={ne:"Комментарии",yk:"Ваше сообщение добавлено на последнюю страницу.",wb:"Редактирование",jm:"темы",im:"комментария",se:"Свеженаписанный комментарий можно редактировать в&nbsp;течение 72&nbsp;часов с&nbsp;момента его добавления. Полная история изменений будет доступна для ознакомления&nbsp;всем.",Lj:"Заголовок",Kj:"Сообщение",Pl:"Ответить на комментарий",Ge:"Сохранить изменения",Jj:"{NUM} комментари{NUM, plural, one {й} many {ев} other {я}}",Lk:"Пользователь",Gk:"Комментарии заблокированы до",
Ik:"Комментарии модератора",Jk:"замаскированный мат в комментариях|мат в комментариях|переход на личности|флуд|флуд бессодержательными комментариями|спам|рекламный спам|писать ЗАГЛАВНЫМИ БУКВАМИ нельзя|писать translitom нельзя|писать на иностранном языке нельзя",Hk:"Заблокировать комментарии на",Fk:"Заблокировать",Kk:"Снять блокировку",gk:"История редактирования",hk:"Скрыть историю",Fb:"Удалить комментарий?",re:"Удалить комментарий",ek:"Комментарий",te:"Изменить",Xl:"Пожаловаться на спам",Ek:"Модерация",
Yg:"Скрыть тему?",Xg:"Скрыть тему",qk:"Скрыть",fm:"Тема скрыта",He:"Удалить тему?",Zg:"Удалить тему",gm:"Удалена"};var Cx={Ga:"Вы уверены?",jd:"Внести в Чёрный список",ze:"Убрать из Чёрного списка"};var kx={"edit-history":{text:qx.gk},"edit-history-hide":{text:qx.hk},edit:{text:qx.te},blacklist:{text:Cx.jd,Ib:_.V?Cx.jd:Cx.Ga},unblacklist:{text:Cx.ze},spam:{text:qx.Xl},"delete":{text:_.or.Za,Ib:_.V?qx.re:qx.Fb,confirm:_.or.Za,cancel:_.or.Fa},mod:{text:qx.Ek,Qd:!0},"thread-hide":{text:qx.Xg,Ib:_.V?qx.Xg:qx.Yg,confirm:qx.qk,cancel:_.or.Fa},"thread-hidden":{text:qx.fm,Uc:!0},"thread-moderate":{text:qx.Zg,Ib:_.V?qx.Zg:qx.He,confirm:_.or.Za,cancel:_.or.Fa,Qd:!0},"thread-moderated":{text:qx.gm,Qd:!0,
Uc:!0}};_.oa(ix,Yw);ix.prototype.v=function(){var a=lx(this);_.D(this.s);this.s=new _.Vs(this.g,a,qx.ek);this.s.ha("select",this.A,!1,this);this.s.open()};ix.prototype.A=function(a){var b=a.target;_.W.g("x-comment-dropdown.select",this.g,_.V?b:this.g,a.action)};ix.prototype.H=function(){_.D(this.s);Yw.prototype.H.call(this)};ex("x-comment-dropdown",ix);var Dx={km:"Добавить фотографию с компьютера"};_.oa(mx,Yw);_.h=mx.prototype;_.h.Wn=function(a){a.files&&1===a.files.length&&(this.files=a.files,this.update())};_.h.co=function(){this.files=[];this.update()};
_.h.render=function(){var a=this,b=nx(this);this.s?b&&(_.dm("button",null,null,"type","button","class","c-button c-button--gray c-upload-button__button"),_.dm("span",null,null,"class","c-upload-button__thumb","style","background-image:url("+b.thumbnail[0]+")"),_.$l(),_.dm("span",null,null,"class","c-upload-button__remove","onclick",function(b){b.preventDefault();_.W.g("upload-button.click",a.g);a.files=[];a.update()}),_.$l(),_.$l()):(_.dm("button",null,null,"data-tt",Dx.km,"type","button","class",
"c-button c-button--gray"),_.dm("span",null,null,"class","c-upload-button__icon"),_.$l(),_.$l())};
_.h.update=function(){var a=nx(this);this.s||(0,_.iv)(this.g,this.render.bind(this));a?(_.Ng(this.ja),_.D(this.i),this.i=null,(0,_.iv)(this.g,this.render.bind(this))):this.s&&!this.i&&(this.g.innerHTML="",this.i=new _.Ns("commentimage","c-button c-button--gray"),_.Ps(this.i,_.bu),this.i.Oe="uploadSimple",this.i.Fc='<span class="c-upload-button__icon"></span>',this.i.render(this.g),this.i.setVisible(!0),this.ja.C(this.i,"ready",this.Wn).C(this.i,"started",this.co))};
_.h.H=function(){try{_.D(this.i)}catch(a){}this.i=null;Yw.prototype.H.call(this)};ex("upload-button",mx);_.oa(ox,Yw);_.h=ox.prototype;_.h.fd=function(a,b){Yw.prototype.fd.call(this,a,b);"text"===a&&(this.A?this.ja.C(b,"focus",this.focus).C(b,"blur",this.Eo):(a=this.s=new _.yt(b.value),a.Xd=b.offsetHeight,_.Bt(a),this.s.pb(b)))};_.h.focus=function(){(0,window.clearTimeout)(this.v);_.B(this.g,"is-collapsed");var a=_.R(this.g,"metrika");a&&_.Un(a)};_.h.Eo=function(){var a=this;this.v=(0,window.setTimeout)(function(){""===a.g.text.value&&_.A(a.g,"is-collapsed")},350)};
_.h.T=function(){var a=this.g,b={_:_.R(a,"type"),text:a.text.value,owner:a.owner.value,ownerId:a.ownerId.value};a.header&&(b.header=a.header.value);a.parent&&(b.parent=a.parent.value);var c=gx("upload-button",a);(c=c&&nx(c))&&(b.image=c.id);(0,_.Y)("comments.comment",{Dc:a.submitbtn,sa:_.Pn(this.j.spinner)}).T("/ajax/forums.cshtml",b).then(function(a){return a.json}).then(this.Op.bind(this)).catch(function(){})};
_.h.Op=function(a){var b=this.g;if(a.url)window.location.href=a.url;else if(a.warning)b='<div class="c-dialog-warning">'+(_.V?"":'<h3 class="c-header">'+_.Mv.Ie+"</h3>")+('<div class="c-dialog-desc">'+a.warning+"</div>")+'<div class="o-group o-group--m o-group--end o-group--wide c-dialog-buttons"><button class="c-button c-button--solid c-button--m-no-padding" type="button" data-action="dialog.close">'+_.Mv.Ig+"</button></div></div>",a=_.hn(this.g.submitbtn),a.ra=_.Mv.Ie,a.content=b,a.render(),a.setVisible(!0);
else if(a.html){_.ln("Comment",b.parent?"Reply":"Post");var c=_.yh(b);a=_.Id(_.Wk(a.html)).querySelector('[data-xtag="x-comment"]');a.style.visibility="hidden";var d=_.F("commentstitle");if(d){var e=d.querySelector(".counter");d.innerHTML=qx.ne+' <span class="counter">'+(e?(0,window.parseInt)(e.innerHTML,10)+1:1)+"</span>"}d=_.L(b,"js-entity");if(d=_.G("js-commentscounter",d))d.innerHTML=_.Fo(new _.Bo(qx.Jj),{NUM:(0,window.parseInt)(d.innerHTML,10)+1});b.header&&(b.header.value="");b.text.value="";
if(d=gx("upload-button",b))d.files=[],d.update();d=!!b.parent;e=""===c.hidden;d?_.Md(a,b):e?_.qh(b.submitbtn,qx.yk):(e=_.L(b,"js-compactcomments"),e=_.G("c-comments",e),"top"===c.position?_.Nd(e,a,0):e.appendChild(a));c=_.yd();e=_.gf(a);c.scrollTop!=e.y&&(new _.zq(c,[0,c.scrollTop],[0,e.y],500,_.Tq)).play();px(this,a,b,d);this.A&&_.K(b)}};_.h.H=function(){_.D(this.s);Yw.prototype.H.call(this)};ex("x-comment-form",ox);var tx=/^(?:abbr|acronym|address|b|em|i|small|strong|su[bp]|u)$/i,sx=/<[!\/]?([a-z0-9]+)([\/ ][^>]*)?>/gi;_.oa(yx,Yw);_.h=yx.prototype;_.h.fd=function(a,b){Yw.prototype.fd.call(this,a,b);switch(a){case "original-link":case "original":a=this.j["original-link"];b=this.j.original;a&&b&&(this.v=new _.Ir(b,a));break;case "reply":this.ja.C(b,"click",this.oq)}};_.h.oq=function(){var a=this,b=_.R(this.j.reply,"parent")||"",c=zx(this,b);b=_.Bn(c);b.ha("end",function(b){b=b.target;var d=b.element;b.hb?c.text.focus():(_.K(d),a.s=null)});_.un(b)};
_.h.sn=function(a){var b=this,c=xx(this,this.i?"ut":"uc",{begin:!0});(0,_.Y)("comments.comment",a).T("/ajax/forums.cshtml",c).then(function(a){return a.json}).then(function(d){var e=qx.wb+" "+(d.header?qx.jm:qx.im),f=d.header,g=d.text,k=d.thumbnail&&0<d.thumbnail.length&&d.thumbnail[0]||"";d=d.canPostImages;f='<div class="c-dialog-editcomment">\n'+(_.V?"":'<h3 class="c-header">'+e+"</h3>")+'\n<div class="c-dialog-desc">'+qx.se+'</div>\n<form class="c-dialog-form" novalidate>\n<div class="c-dialog-form__field">\n'+
(f?'<label class="c-dialog-form__legend" for="{id}.h">'+qx.Lj+'</label>\n    <input class="c-input" type="text" name="header" id="{id}.h" value="'+_.rb(f||"")+'"></div>\n    <div class="c-dialog-form__field">\n    <label class="c-dialog-form__legend" for="{id}.t">'+qx.Kj+'</label>\n    <div class="c-dialog-form__field">':"")+'\n<textarea class="c-textarea"  name="text" id="{id}.t" data-autofocus="1">'+_.rb(g||"")+'</textarea></div>\n<div class="o-group o-group--m o-group--end o-group--wide c-dialog-buttons">\n<span class="c-dialog-buttons__spinner is-skip js-spinner"></span>\n'+
(f||!d&&!k?"":'<label class="c-upload-button"'+(k?' data-thumb="'+k+'"':"")+' data-xtag="upload-button"></label>')+'\n<button class="c-button c-button--solid c-button--m-no-padding" name="submitbtn" type="submit">'+qx.Ge+"</button>\n</div>\n</form>\n</div>";var l=new _.Qn(a,f,e);_.Rn(l);b.ja.C(l,"submit",function(a){a=a.target;var d=Object.assign({},c,{text:a.text.value});delete d.begin;a.header&&(d.header=a.header.value);var e=gx("upload-button",a),f=e&&nx(e);e=f&&f.id;var g=!!k;f=g&&f&&!f.id;g&&
f||(d.image=e||"");(0,_.Y)("comments.comment",a.submitbtn).T("/ajax/forums.cshtml",d).then(function(a){return a.json}).then(function(a){l.close();_.ln("Comment","Edit");var c=_.O("js-text",b.g);a.text&&(c.innerHTML=a.text);(c=window.document.getElementById("thread-header"))&&a.header&&(c.innerHTML=a.header)}).catch(function(){_.Sn(l)})})}).catch(function(){})};
_.h.lh=function(a,b){var c=this.ub.user;b={_:b?"add":"remove",id:c};(0,_.Y)("comments.comment",a).T("/ajax/blacklist.cshtml",b).then(function(){fx("x-comment").filter(function(a){return _.R(a.g,"user")===c}).forEach(function(a){(a=gx("x-comment-dropdown",a.g))&&jx(a)})}).catch(function(){})};_.h.rq=function(a){var b=this.ub.user,c=_.O("js-text",this.g);c=c?_.ao.Yl+": "+_.rb(ux(c.innerHTML)):"";_.co(a,"commentspam",b,"user",{text:c})};_.h.H=function(){_.D(this.v);Yw.prototype.H.call(this)};
ex("x-comment",yx);_.T(_.S,"comments",null,{dt:Ax,mt:Ax,mod:function(a){a=a.node();var b=_.yh(a),c={_:"getUserCommentsModerationData",userId:b.user,forumId:b.forum,messageId:b.id};b.thread&&(c.threadId=b.thread);rx(a,c)},moddel:function(a){var b=a.node();a=_.yh(b);var c=""===a.thread,d={_:c?"dt":"dc",owner:a.owner,ownerId:a.ownerid,id:a.id};_.th(b,c?qx.He:qx.Fb,_.or.Za,_.or.Fa).then(function(){(0,_.Y)("comments.ext",b).T("/ajax/forums.cshtml",d).then(function(){var a=b.closest("li"),c=_.O("js-link",a);a=_.O("js-moddel",
a);var d=window.document.createElement("span");d.className="u-deleted";_.K(a);for(c.appendChild(d);c.firstChild!==d;)d.appendChild(c.firstChild)}).catch(function(){})}).catch(function(){})}});_.Mi("video",function(){_.T(_.S,"video",null,{play:Bx})});})(__d2)}
