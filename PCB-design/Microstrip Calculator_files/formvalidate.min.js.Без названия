function Trim(e){return e.length<1?"":(e=RTrim(e),e=LTrim(e),""==e?"":e)}function RTrim(e){var t=String.fromCharCode(32),r=e.length,n="";if(0>r)return"";for(var i=r-1;i>-1;){if(e.charAt(i)!=t){n=e.substring(0,i+1);break}i-=1}return n}function LTrim(e){var t=String.fromCharCode(32);if(1>r)return"";for(var r=e.length,n="",i=0;r>i;){if(e.charAt(i)!=t){n=e.substring(i,r);break}i+=1}return n}function isOkBag(e,t){var r;for(r=0;r<e.length;r++){var n=e.charAt(r);if(-1==t.indexOf(n))return!1}return!0}function isEmpty(e){return null==e||0==e.length}function isWhiteSpace(e){var t;if(isEmpty(e))return!0;for(t=0;t<e.length;t++){var r=e.charAt(t);if(-1==whitespace.indexOf(r))return!1}return!0}function stripCharsInBag(e,t){var r,n="";for(r=0;r<e.length;r++){var i=e.charAt(r);-1==t.indexOf(i)&&(n+=i)}return n}function stripCharsNotInBag(e,t){var r,n="";for(r=0;r<e.length;r++){var i=e.charAt(r);-1!=t.indexOf(i)&&(n+=i)}return n}function stripWhitespace(e){return stripCharsInBag(e,whitespace)}function charInString(e,t){for(i=0;i<t.length;i++)if(t.charAt(i)==e)return!0;return!1}function stripInitialWhitespace(e){for(var t=0;t<e.length&&charInString(e.charAt(t),whitespace);)t++;return e.substring(t,e.length)}function isLetter(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e}function isDigit(e){return e>="0"&&"9">=e}function isLetterOrDigit(e){return isLetter(e)||isDigit(e)}function isInteger(e){var t;if(isEmpty(e))return 1==isInteger.arguments.length?defaultEmptyOK:1==isInteger.arguments[1];for(t=0;t<e.length;t++){var r=e.charAt(t);if(!isDigit(r))return!1}return!0}function isSignedInteger(e){if(isEmpty(e))return 1==isSignedInteger.arguments.length?defaultEmptyOK:1==isSignedInteger.arguments[1];var t=0,r=defaultEmptyOK;return isSignedInteger.arguments.length>1&&(r=isSignedInteger.arguments[1]),("-"==e.charAt(0)||"+"==e.charAt(0))&&(t=1),isInteger(e.substring(t,e.length),r)}function isPositiveInteger(e){var t=defaultEmptyOK;return isPositiveInteger.arguments.length>1&&(t=isPositiveInteger.arguments[1]),isSignedInteger(e,t)&&(isEmpty(e)&&t||parseInt(e)>0)}function isNonnegativeInteger(e){var t=defaultEmptyOK;return isNonnegativeInteger.arguments.length>1&&(t=isNonnegativeInteger.arguments[1]),isSignedInteger(e,t)&&(isEmpty(e)&&t||parseInt(e)>=0)}function isNegativeInteger(e){var t=defaultEmptyOK;return isNegativeInteger.arguments.length>1&&(t=isNegativeInteger.arguments[1]),isSignedInteger(e,t)&&(isEmpty(e)&&t||parseInt(e)<0)}function isNonpositiveInteger(e){var t=defaultEmptyOK;return isNonpositiveInteger.arguments.length>1&&(t=isNonpositiveInteger.arguments[1]),isSignedInteger(e,t)&&(isEmpty(e)&&t||parseInt(e)<=0)}function isFloat(e){var t,r=!1;if(isEmpty(e))return 1==isFloat.arguments.length?defaultEmptyOK:1==isFloat.arguments[1];if(e==decimalPointDelimiter)return!1;for(t=0;t<e.length;t++){var n=e.charAt(t);if(n!=decimalPointDelimiter||r){if(!isDigit(n))return!1}else r=!0}return!0}function isSignedFloat(e){if(isEmpty(e))return 1==isSignedFloat.arguments.length?defaultEmptyOK:1==isSignedFloat.arguments[1];var t=0,r=defaultEmptyOK;return isSignedFloat.arguments.length>1&&(r=isSignedFloat.arguments[1]),("-"==e.charAt(0)||"+"==e.charAt(0))&&(t=1),isFloat(e.substring(t,e.length),r)}function isAlphabetic(e){var t;if(isEmpty(e))return 1==isAlphabetic.arguments.length?defaultEmptyOK:1==isAlphabetic.arguments[1];for(t=0;t<e.length;t++){var r=e.charAt(t);if(!isLetter(r))return!1}return!0}function isAlphanumeric(e){var t;if(isEmpty(e))return 1==isAlphanumeric.arguments.length?defaultEmptyOK:1==isAlphanumeric.arguments[1];for(t=0;t<e.length;t++){var r=e.charAt(t);if(!isLetter(r)&&!isDigit(r))return!1}return!0}function reformat(e){for(var t,r=0,n="",i=1;i<reformat.arguments.length;i++)t=reformat.arguments[i],i%2==1?n+=t:(n+=e.substring(r,r+t),r+=t);return n}function reformatZIPCode(e){return 5==e.length?e:reformat(e,"",5,"-",4)}function reformatUSPhone(e){return reformat(e,"(",3,") ",3,"-",4)}function reformatSSN(e){return reformat(e,"",3,"-",2,"-",4)}function isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}function daysInMonth(e,t){switch(Number(e)){case 1:case 3:case 5:case 7:case 8:case 10:case 12:return 31;case 4:case 6:case 9:case 11:return 30;case 2:return isLeapYear(t)?29:28;default:return 0}}function getDateSeparator(e){return e.indexOf("-")>0&&e.indexOf("/")>0?" ":e.indexOf("-")>0?"-":e.indexOf("/")>0?"/":" "}function getYear(e){var t=getDateSeparator(e);return" "==t?0:3==e.split(t).length?e.split(t)[2]:0}function getMonth(e){var t=getDateSeparator(e);return" "==t?0:3==e.split(t).length?e.split(t)[0]:0}function getDay(e){var t=getDateSeparator(e);return" "==t?0:3==e.split(t).length?e.split(t)[1]:0}function isProperDay(e,t,r){return isWhiteSpace(e)||0==e?!1:e>0&&e<daysInMonth(t,r)+1?!0:!1}function isProperMonth(e){return isWhiteSpace(e)||0==e?!1:e>0&&13>e?!0:!1}function isProperYear(e){if(isWhiteSpace(e)||e.toString().length>4||3==e.toString().length)return!1;switch(e.toString().length){case 1:return e>=0&&10>e?!0:!1;case 2:return e>=0&&100>e?!0:!1;case 4:return(e>=1900||e>=2e3)&&(3e3>e||2e3>e)?!0:!1;default:return!1}}function isProperDate(e){var t=getDay(e),r=getMonth(e),n=getYear(e);return isProperDay(t,r,n)&&isProperMonth(r)&&isProperYear(n)}function charOccurences(e,t){for(var r=0,n=0;n<e.length;n++)e.charAt(n)==t&&r++;return r}function isProperEmail(e){if(charOccurences(e,"@")+charOccurences(e,".")<2)return!1;var t=e.indexOf("@"),r=e.indexOf(".");if(0==t||t==e.length-1)return!1;if(0==r||r==e.length-1)return!1;var n=1,i=/^(com|net|org|edu|int|mil|gov|arpa|biz|aero|name|coop|info|pro|museum)$/,a=/^(.+)@(.+)$/,s='\\(\\)><@,;:\\\\\\"\\.\\[\\]',l="[^\\s"+s+"]",o='("[^"]*")',u=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/,c=l+"+",h="("+c+"|"+o+")",g=new RegExp("^"+h+"(\\."+h+")*$"),f=(new RegExp("^"+c+"(\\."+c+")*$"),e.match(a));if(null==f)return!1;var d=f[1],m=f[2];for(v=0;v<d.length;v++)if(d.charCodeAt(v)>127)return!1;for(v=0;v<m.length;v++)if(m.charCodeAt(v)>127)return!1;if(null==d.match(g))return!1;var p=m.match(u);if(null!=p){for(var v=1;4>=v;v++)if(p[v]>255)return!1;return!0}var b=new RegExp("^"+c+"$"),A=m.split("."),S=A.length;for(v=0;S>v;v++)if(-1==A[v].search(b))return!1;return n&&2!=A[A.length-1].length&&-1==A[A.length-1].search(i)?!1:2>S?!1:!0}function isProperNumber(e){var t=Number(e);return isNaN(t)?!1:!isWhiteSpace(e)}function isProperAlphabetic(e){for(var t="abcdefghijklmnopqrstuvwxyz ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e.length;r++)if(-1==t.indexOf(e.charAt(r)))return!1;return!0}function objectValue(e,t){var r,n=null;for(r=0;r<e.length;r++)e[r].name==t&&(n=e[r]);switch(n.type){case"text":case"hidden":case"password":return n.value;case"select-one":return 0==n.length?"":n.options[n.selectedIndex].value;case"radio":for(r=0;r<e.length;r++)if(e[r].name==t&&e[r].checked)return e[r].value;return""}}function objectFocus(e,t){var r,n=null;for(r=0;r<e.length;r++)e[r].name==t&&(n=e[r]);n.focus()}function isProperZip(e){return 5==e.length||9==e.length?isProperNumber(e):10==e.length?isProperNumber(e.substr(0,5))&&isProperNumber(e.substr(6,4))&"-"==e.charAt(5):void 0}function isProperUSPhone(e){var t=stripCharsNotInBag(e,"0123456789");return isOkBag(e,"01234567890 -().")&&isInteger(t)&&t.length==digitsInUSPhoneNumber}function isProperUSSSN(e){var t=stripCharsNotInBag(e,"0123456789");return isOkBag(e,"01234567890-")&&isInteger(t)&&11==t.length}function actionFields(e){if(this.email=e.indexOf("[email]")>-1,this.required=e.indexOf("[req]")>-1,this.checkDate=e.indexOf("[date]")>-1,this.checkZip=e.indexOf("[zip]")>-1,this.checkNumber=e.indexOf("[number]")>-1,this.checkAlphabetic=e.indexOf("[alpha]")>-1,this.checkUSPhone=e.indexOf("[usphone]")>-1,this.checkUSSSN=e.indexOf("[usssn]")>-1,e.indexOf("[len=")>-1){this.checkLength=!0;for(var t="",r=!0,n=e.indexOf("[len=")+5;n<e.length&&r;n++)"]"!=e.charAt(n)?t+=e.charAt(n):r=!1;this.lengthToCheck=t}else this.checkLength=!1;if(e.indexOf("[blankalert=")>-1){this.blankAlert=!0;for(var i="",r=!0,n=e.indexOf("[blankalert=")+12;n<e.length&&r;n++)"]"!=e.charAt(n)?i+=e.charAt(n):r=!1;this.blankAlertMessage=i}else this.blankAlert=!1;if(e.indexOf("[invalidalert=")>-1){this.invalidAlert=!0;for(var i="",r=!0,n=e.indexOf("[invalidalert=")+14;n<e.length&&r;n++)"]"!=e.charAt(n)?i+=e.charAt(n):r=!1;this.invalidAlertMessage=i}else this.invalidAlert=!1;if(e.indexOf("[equals=")>-1){this.shouldEqual=!0;for(var a="",r=!0,n=e.indexOf("[equals=")+8;n<e.length&&r;n++)"]"!=e.charAt(n)?a+=e.charAt(n):r=!1;this.shouldEqualString=a}else this.shouldEqual=!1}function validateForm(e){var t,r,n=e.elements;submitonce(e);for(var i=0;i<n.length;i++)if(r=n[i],t=r.name,"hidden"==r.type&&t.length>5&&"_vldt"==t.substr(t.length-5).toLowerCase()){var a=new actionFields(objectValue(n,t)),s=t.substr(0,t.length-5);if(a.required&&isWhiteSpace(objectValue(n,s)))return alert(a.blankAlert?a.blankAlertMessage:s+" cannot be left blank"),objectFocus(n,s),submitenabled(e),!1;if(objectValue(n,s)>""&&!isWhiteSpace(objectValue(n,s))){if(a.checkDate&&!isProperDate(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have an invalid date"),objectFocus(n,s),submitenabled(e),!1;if(a.checkNumber&&!isProperNumber(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have an invalid number"),objectFocus(n,s),submitenabled(e),!1;if(a.checkZip&&!isProperZip(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have an invalid zipcode"),objectFocus(n,s),submitenabled(e),!1;if(a.checkAlphabetic&&!isProperAlphabetic(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have invalid characters"),objectFocus(n,s),submitenabled(e),!1;if(a.checkUSPhone&&!isProperUSPhone(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have invalid characters"),objectFocus(n,s),submitenabled(e),!1;if(a.checkUSSSN&&!isProperUSSSN(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have invalid characters"),objectFocus(n,s),submitenabled(e),!1;if(a.email&&!isProperEmail(objectValue(n,s)))return alert(a.invalidAlert?a.invalidAlertMessage:s+" cannot have invalid characters"),objectFocus(n,s),submitenabled(e),!1;if(a.checkLength&&objectValue(n,s).length<a.lengthToCheck)return alert(a.invalidAlert?a.invalidAlertMessage:s+" must be at least "+a.lengthToCheck+" characters long"),objectFocus(n,s),submitenabled(e),!1}}return!0}function submitenabled(e){if(document.all||document.getElementById)for(i=0;i<e.length;i++){var t=e.elements[i];("submit"==t.type.toLowerCase()||"reset"==t.type.toLowerCase())&&(t.disabled=!1)}}function submitonce(e){if(document.all||document.getElementById)for(i=0;i<e.length;i++){var t=e.elements[i];("submit"==t.type.toLowerCase()||"reset"==t.type.toLowerCase())&&(t.disabled=!0)}}function observeWindowLoad(e){if(window.addEventListener)window.addEventListener("load",e,!1);else if(document.addEventListener)document.addEventListener("load",e,!1);else if(window.attachEvent)window.attachEvent("onload",e);else if("function"==typeof window.onload){var t=window.onload;window.onload=function(){t(),e()}}else window.onload=init}var digits="0123456789",lowercaseLetters="abcdefghijklmnopqrstuvwxyz",uppercaseLetters="ABCDEFGHIJKLMNOPQRSTUVWXYZ",whitespace=" 	\n\r",decimalPointDelimiter=".",phoneNumberDelimiters="()- ",validUSPhoneChars=digits+phoneNumberDelimiters,validWorldPhoneChars=digits+phoneNumberDelimiters+"+",SSNDelimiters="- ",validSSNChars=digits+SSNDelimiters,digitsInSocialSecurityNumber=9,digitsInUSPhoneNumber=10,ZIPCodeDelimiters="-",ZIPCodeDelimeter="-",validZIPCodeChars=digits+ZIPCodeDelimiters,digitsInZIPCode1=5,digitsInZIPCode2=9,creditCardDelimiters=" ";